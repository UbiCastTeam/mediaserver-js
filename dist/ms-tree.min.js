function MSTreeManager(e){if(this.$place=null,this.msapi=null,this.display_root=!1,this.display_personal=!1,this.auto_init=!0,this.current_channel_oid="0",this.on_change=null,this.on_data_retrieved=null,this.on_tree_loaded=null,this.channels_base_url="/channels/#",this.channels_url_field="slug",this.tree_url="",this.path_url="",this.$widget=null,this.loaded=!1,this.loading=!1,this.content={0:{oid:"0",parent_oid:null}},this.loading_queue={},this.has_personal_channel=!1,this.personal_channel_info=null,utils.setup_class(this,e,["$place","msapi","display_root","display_personal","auto_init","current_channel_oid","on_change","on_data_retrieved","on_tree_loaded","channels_base_url","channels_url_field","tree_url","path_url"]),this.initial_oid=this.current_channel_oid,this.msapi||(this.msapi=new MSAPIClient(e)),this.auto_init){var t=this;$(document).ready(function(){t.init()})}}MSTreeManager.prototype.init=function(){var e,t;if(!this.loaded&&!this.loading){if(!this.$place)return console.log("No place defined for tree.");if(!this.$place.length)return console.log("Place for tree doesn't exist. Requested place:",this.$place);for(this.loading=!0,window.location.search&&(this.channels_base_url=this.channels_base_url.substring(0,this.channels_base_url.length-1)+window.location.search+"#"),this.id_prefix="";$("#"+this.id_prefix+"tree_channel_0").length>0;)this.id_prefix+="_";e="<div>",this.display_root&&(e+='<div id="'+this.id_prefix+'tree_channel_0_link" '+("0"==this.current_channel_oid?'class="channel-active"':"")+">",this.on_change?e+='<button type="button" data-ref="0" class="channel-btn"'+("0"==this.current_channel_oid?'title="'+utils.translate("Root")+" "+utils.translate("selected")+'"':"")+">"+utils.translate("Root")+"</button>":e+='<a href="'+this.channels_base_url+'" class="channel-btn"'+("0"==this.current_channel_oid?'title="'+utils.translate("Root")+" "+utils.translate("selected")+'"':"")+">"+utils.translate("Root")+"</a>",e+="</div>"),e+='<ul class="list js-active-item border-color-blue active" id="'+this.id_prefix+'tree_channel_0"></ul></div>',this.$widget=$(e),this.display_root&&this.on_change&&$(".channel-btn",this.$widget).click({obj:this},function(e){e.data.obj.on_change($(this).attr("data-ref"))}),t=this,this.loading=!1,this.load_tree("0",function(e){if(t.loaded=!0,e.success&&t.initial_oid&&t.current_channel_oid==t.initial_oid&&t.open_tree(t.current_channel_oid),t.display_personal&&t.has_personal_channel){var n=$('<button type="button" class="button channel-personal-btn"><i class="fa fa-bookmark" aria-hidden="true"></i> <span>'+utils.translate("My channel")+"</span></button>");n.click({obj:t},function(e){e.data.obj.open_personal_channel()}),t.$widget.prepend(n)}t.$place.empty(),t.$place.append(t.$widget),t.on_tree_loaded&&t.on_tree_loaded()})}},MSTreeManager.prototype.load_tree=function(e,t){var n,a,s,i,o;if(void 0!==e)if(this.content[e]&&this.content[e].loaded)t&&t({success:!0,oid:e});else if(this.loading)this.loading_queue[e]=t;else{if(this.loading=!0,this.content[e]||(this.content[e]={oid:e}),n={recursive:"no"},"0"!=e&&(n.parent_oid=e),a=this,!(s=$("#"+this.id_prefix+"tree_channel_"+e,this.$widget)).length)return this.loading=!1,void(t&&t({success:!0,oid:e}));this.content[e].timeout=setTimeout(function(){a.content[e].timeout=null,s.css("display","block"),s.html('<li style="display: block;"><i class="fa fa-spinner fa-spin" aria-hidden="true"></i> '+utils.translate("Loading")+"...</li>")},500),i=function(n){a._on_tree_loaded(n,e,s,t)},o=function(n,i,o){if(n.status){if(401==n.status)return a._on_tree_loaded({success:!1,error:utils.translate("Unable to get channels tree because you are not logged in.")},e,s,t);if(403==n.status)return a._on_tree_loaded({success:!1,error:utils.translate("Unable to get channels tree because you cannot access to this channel.")},e,s,t);if(404==n.status)return a._on_tree_loaded({success:!1,error:utils.translate("Channel does not exist.")},e,s,t);if(500==n.status)return a._on_tree_loaded({success:!1,error:utils.translate("An error occurred in the server. Please try again later.")},e,s,t)}"timeout"==i?a._on_tree_loaded({success:!1,error:utils.translate("Unable to get channels tree. Request timed out.")},e,s,t):"error"==i?a._on_tree_loaded({success:!1,error:utils.translate("The server cannot be reached.")},e,s,t):a._on_tree_loaded({success:!1,error:utils.translate("An error occurred during request:")+"<br/>&nbsp;&nbsp;&nbsp;&nbsp;"+i+" "+o},e,s,t)},this.tree_url?$.ajax({url:this.tree_url,data:n,dataType:"json",cache:!1,success:i,error:o}):this.msapi.ajax_call("get_channels_tree",n,function(e){e.success?i(e):o(e.xhr,e.textStatus,e.thrownError)})}},MSTreeManager.prototype._on_tree_loaded=function(e,t,n,a){var s,i,o,r,l,c,d;if(this.content[t].timeout&&(clearTimeout(this.content[t].timeout),delete this.content[t].timeout),e.success){if(e.channels){for(i="",o=0;o<e.channels.length;o++){if((r=e.channels[o]).parent_oid="0"!=t?t:"0",this.content[r.oid])for(l in r)this.content[r.oid][l]=r[l];else this.content[r.oid]=r;this.on_data_retrieved&&this.on_data_retrieved(r),c="",r.channels&&(c='<button type="button" aria-expanded="false" aria-controls="tree_channel_'+r.oid+'" aria-label="'+r.title+'" data-ref="'+r.oid+'" class="channel-toggle button-text list-entry"><i class="fa fa-fw fa-angle-right" aria-hidden="true"></i></button>'),i+='<li><span id="'+this.id_prefix+"tree_channel_"+r.oid+'_link" data-ref="'+r.oid+'" class="'+(this.on_change?"":"aside-list-btn")+(this.current_channel_oid==r.oid?" channel-active":"")+'">'+c,this.on_change?i+="<button "+(r.language?'lang="'+r.language+'"':"")+' type="button" data-ref="'+r.oid+'" class="channel-btn"'+(this.current_channel_oid==r.oid?' title="'+utils.escape_html(r.title)+" "+utils.translate("selected")+'"':"")+">"+utils.escape_html(r.title)+"</button>":i+="<a "+(r.language?'lang="'+r.language+'"':"")+' href="'+this.channels_base_url+r[this.channels_url_field]+'" class="channel-btn">'+utils.escape_html(r.title)+"</a>",i+="</span>",r.channels&&(i+='<ul class="list border-color-blue" id="'+this.id_prefix+"tree_channel_"+r.oid+'"></ul>'),i+="</li>",void 0!==this.loading_queue[r.oid]&&(s={oid:r.oid,cb:this.loading_queue[r.oid]},delete this.loading_queue[r.oid])}d=$(i),n.empty(),n.append(d),this.on_change&&$(".channel-btn",d).click({obj:this},function(e){e.data.obj.on_change($(this).attr("data-ref"))}),$(".channel-toggle",d).click({obj:this},function(e){e.stopPropagation(),e.data.obj.toggle_channel($(this).attr("data-ref"))}),$(".aside-list-btn",d).click({obj:this},function(e){e.stopPropagation(),e.data.obj.toggle_channel($(this).attr("data-ref"))})}this.content[t].loaded=!0,e.personal_channel&&(this.has_personal_channel=!0)}else e.error?n.html('<li class="error">'+e.error+"</li>"):n.html('<li class="error">'+utils.translate("No information about error.")+"</li>");this.loading=!1,s&&this.load_tree(s.oid,s.cb),a&&(e.oid=t,a(e))},MSTreeManager.prototype.open_tree=function(e){var t,n;"0"!=e&&(t=this,n=function(){for(var n,a=[],s=t.content[e];s;)a.push(s.oid),s=t.content[s.parent_oid];for(a.reverse(),n=0;n<a.length;n++)"0"!=a[n]&&t.load_tree(a[n],function(e){$("#"+t.id_prefix+"tree_channel_"+e.oid,t.$widget).css("display","block").addClass("active"),$("#"+t.id_prefix+"tree_channel_"+e.oid+"_link .channel-toggle",t.$widget).addClass("fa-rotate-90"),$("#"+t.id_prefix+"tree_channel_"+e.oid+"_link .channel-toggle",t.$widget).attr("aria-expanded",!0)})},this.content[e]||(this.content[e]={oid:e}),void 0===this.content[e].parent_oid?this.load_path(e,function(a){var s,i,o,r=[];for(a.path&&a.path.length>0&&(r=a.path),r.push(t.content[e]),s=0;s<r.length;s++){if((i=r[s]).parent_oid=s>0?r[s-1].oid:"0",t.content[i.oid])for(o in i)t.content[i.oid][o]=i[o];else t.content[i.oid]=i;t.on_data_retrieved&&t.on_data_retrieved(i)}n()}):n())},MSTreeManager.prototype.close_tree=function(e){$("#"+this.id_prefix+"tree_channel_"+e,this.$widget).css("display","none").removeClass("active"),$("#"+this.id_prefix+"tree_channel_"+e+"_link .channel-toggle",this.$widget).attr("aria-expanded",!1),$("#"+this.id_prefix+"tree_channel_"+e+"_link .channel-toggle",this.$widget).removeClass("fa-rotate-90")},MSTreeManager.prototype.toggle_channel=function(e){$("#"+this.id_prefix+"tree_channel_"+e+"_link .channel-toggle",this.$widget).hasClass("fa-rotate-90")?this.close_tree(e):this.open_tree(e)},MSTreeManager.prototype.set_active=function(e){this.current_channel_oid!=e&&($(".channel-active button",this.$widget).removeAttr("title"),$(".channel-active",this.$widget).removeClass("channel-active"),this.current_channel_oid=e,$("#"+this.id_prefix+"tree_channel_"+this.current_channel_oid+"_link",this.$widget).addClass("channel-active"),$("#"+this.id_prefix+"tree_channel_"+this.current_channel_oid+"_link button",this.$widget).attr("title",$("#"+this.id_prefix+"tree_channel_"+this.current_channel_oid+"_link",this.$widget).text()+" "+utils.translate("selected")),this.open_tree(e))},MSTreeManager.prototype.load_path=function(e,t){var n={oid:e},a=function(n){n.success||console.log("Error getting path for oid "+e+". Error: "+n.error),t(n)},s=function(n,a,s){console.log("Error getting path for oid "+e+". Error: "+a+" | "+s),t({success:!1,error:a+" | "+s})};this.path_url?$.ajax({url:this.path_url,data:n,dataType:"json",cache:!1,success:a,error:s}):this.msapi.ajax_call("get_channels_path",n,function(e){e.success?a(e):s(e.xhr,e.textStatus,e.thrownError)})},MSTreeManager.prototype.open_personal_channel=function(){var e=this,t=function(t){t.success?(e.personal_channel_info=t,$(".channel-personal-btn span",e.$widget).html(utils.translate("My channel")),e.open_tree(t.oid),e.on_change?e.on_change(t.oid):window.location.hash="#"+t.slug):$(".channel-personal-btn span",e.$widget).html(utils.translate("My channel")+" ("+t.xhr.status+")")};this.personal_channel_info?t(this.personal_channel_info):this.msapi.ajax_call("get_channels_personal",{},function(e){t(e)})},utils.add_translations({"Access denied.":"Accès refusé.","Add a channel":"Ajouter une chaîne","Add a sub channel":"Ajouter une sous chaîne","Add a video":"Ajouter une vidéo","Add date, ascending":"Date d'ajout, croissante","Add date, descending":"Date d'ajout, décroissante","Added on":"Ajouté le",all:"tout","An error occurred during request:":"Une erreur est survenue pendant la requête :","An error occurred in the server. Please try again later.":"La requête a échoué. Veuillez réessayer plus tard.","An internal server error occurred. An email has been sent to the support team.":"Une erreur interne au serveur est survenue. Un email a été envoyé à l'équipe de support afin de résoudre le problème.","Annotations last month":"Annotations ce mois",Annotations:"Annotations",annotations:"annotations",Apply:"Appliquer",April:"avril",at:"à",August:"ao&ucirc;t","Available space:":"Espace disponible :",B:"o","cannot copy":"impossible de copier",Categories:"Catégories",categories:"catégories","Channel content:":"Contenu de la chaîne :",channel:"chaîne","channel(s)":"chaîne(s)","Channel:":"Chaîne :","Channels list":"Liste des chaînes",channels:"chaînes",Channels:"Chaînes",chapters:"chapitres","classic RichMedia":"RichMedia classique","Click to display the content of this channel":"Cliquez pour afficher cette chaîne","Click to select this media":"Cliquez pour sélectionner ce média","comments, slides, ...":"commentaires, diapositives, ...",companies:"sociétés","Content types to display:":"Types de contenu à afficher :","Content types":"Types de contenu",copied:"copié","Copy LTI link":"Copier le lien LTI","Created on":"Créé le","Creation date, ascending":"Date de création, croissante","Creation date, descending":"Date de création, décroissante","Current channel":"Chaîne courante",December:"d&eacute;cembre",descriptions:"descriptions","Display channel":"Afficher la chaîne","Display channels":"Afficher les chaînes","display items type icons":"afficher les icônes de type des éléments","Display mode:":"Mode d'affichage :","Display parent channel":"Afficher la chaîne parente","Display {count} more items":"Afficher {count} vidéos de plus",Display:"Affichage",Duration:"Durée","dynamic RichMedia":"RichMedia dynamique","Edit it":"Éditer","Edit this channel":"Éditer cette chaîne",Edit:"Éditer","Editable:":"Éditable:","failed to copy":"échec de la copie",February:"f&eacute;vrier","Filters:":"Filtres :",Go:"Envoyer",help:"aide","Hide this window":"Fermer cette fenêtre","Information about media":"Informations sur le média","Item not found.":"Élément introuvable.","iTunes (audio only)":"iTunes (audio uniquement)",January:"janvier",July:"juillet",June:"juin",keywords:"mots clés","Latest content added":"Contenu récemment ajouté","Latest content":"Contenu récent",licenses:"licences",list:" liste","live stream(s)":"diffusion(s) en direct","live streams":"diffusions en direct","Live streams":"Diffusions en direct",Loading:"Chargement","Loading...":"Chargement ...",locations:"emplacements","Main channels":"Chaînes principales",March:"mars","Matching annotations:":"Annotations correspondantes :","Matching items:":"Éléments correspondants :","Matching photos:":"Photos correspondantes :",May:"mai","Media does not exist.":"Le média n'existe pas.","My channel":"Ma chaîne","My media":"Mes médias","No available space":"Pas d'espace disponible","No contents.":"Pas de contenu.","No information about error.":"Informations sur le média","No information about media.":"Pas d'informations sur le média","No results.":"Pas de résultats.",no:"non",none:"aucun",November:"novembre","Number of annotations, ascending":"Nombre de annotations, croissant","Number of annotations, descending":"Nombre de annotations, décroissant","Number of views, ascending":"Nombre de vues, croissant","Number of views, descending":"Nombre de vues, décroissant",October:"octobre","Open information panel":"Ouvrir le panneau d'information","Parent channel":"Chaîne parente","Parent channel:":"Chaîne parente :","photos group(s)":"groupe(s) de photos","photos groups":"groupes de photos","Photos groups":"Groupes de photos",photos:"photos","Please login to access this channel":"Veuillez vous connecter pour accéder à cette chaîne","Published:":"Publié:","Publishing date":"Date de publication","Recording date":"Date d'enregistrement","Requested channel does not exist.":"La chaîne demandée n'existe pas.",Root:"Racine","Search for":"Contenu à rechercher","Search in my media":"Rechercher dans mes médias","Search in progress":"Recherche en cours","Search in":"Rechercher dans","Search results for:":"Résultats de recherche pour:",Search:"Rechercher","Search:":"Rechercher :",See:"Voir","Select a channel to display its content.":"Sélectionnez une chaîne pour afficher son contenu.","Select a channel":"Sélectionner une chaîne","Select a media":"Sélectionner un média","Select this channel":"Sélectionner cette chaîne","Select this media":"Sélectionner ce média",September:"septembre","Sign in":"Connection","Some contents may still exist in this channel but if it is the case your account is not allowed to see them.":"Du contenu peut tout de même être présent dans cette chaîne mais si c'est le cas, votre compte utilisateur ne possède pas la permission de le voir.","Sort by:":"Trier par :",Speaker:"Intervenant","Speaker:":"Intervenant :",speakers:"intervenants",standard:"standard","Storage usage:":"Stockage utilisé :","Sub channels items are included in counts.":"Les éléments contenus dans les sous chaînes sont inclus dans les comptes.","Sub channels":"Sous chaînes","Subscribe to channel videos RSS":"S'abonner au flux RSS des vidéos de la chaîne","Subscribe to channel videos RSS:":"S'abonner au flux RSS des vidéos de la chaîne :","The connection timed out. Please retry later.":"Le délai d'attente de réponse a été dépassé. Veuillez réessayez plus tard.","The query has been found in audio:":"Le mot recherché a été trouvé dans la bande audio de cette vidéo :","The query has been found in following photos:":"Le mot recherché a été trouvé dans les photos suivantes :","The query has been found in following slides:":"Le mot recherché a été trouvé dans les diapositives suivantes :","The server cannot be reached.":"Le serveur est injoignable.","The storage quota of the parent channels can have an impact on the available space of this channel.":"Le quota de stockage des chaînes en amont peut avoir un impact sur l'espace disponible dans cette chaîne.","This channel contains no media.":"Cette chaîne ne contient pas de médias","This channel contains no sub channels and no media.":"Cette chaîne ne contient pas de sous chaînes ni de médias","This channel contains no sub channels.":"Cette chaîne ne contient pas de sous chaînes","This channel is selected":"Cette chaîne est sélectionnée","This channel is unlisted":"Cette chaîne est non listée","This item is a channel":"Cet élément est une chaîne","This item is a live stream":"Cet élément est une diffusion en direct","This item is a photos group":"Cet élément est un groupe de photos","This item is a video":"Cet élément est une vidéo","This list presents all media and channels ordered by add date.":"Cette liste présente les derniers éléments ajoutés triés par date d'ajout.","This media is not published":"Ce média n'est pas publié","This media is published and unlisted":"Ce média est publié et non listé","This media is published":"Ce média est publié","This media is selected":"Ce média est sélectionné","this month":"ce mois","This video is not ready":"Cette vidéo n'est pas prête",thumbnails:"vignettes","Title, ascending":"Titre, croissant","Title, descending":"Titre, décroissant",titles:"titres","Type:":"Type :","Unable to get channel content because you cannot access to this channel.":"Impossible d'obtenir la liste du contenu de la chaîne car vous ne disposez pas du droit d'accès à cette chaîne.","Unable to get channel content. Request timed out.":"Impossible d'obtenir le contenu de la chaîne. Délai d'attente pour la requête expiré.","Unable to get channel information because you cannot access to this channel.":"Impossible d'obtenir les informations sur la chaîne car vous ne pouvez pas accéder à cette chaîne.","Unable to get channels tree because you are not logged in.":"Impossible d'obtenir la liste des chaînes, vous n'êtes pas authentifié","Unable to get channels tree because you cannot access to this channel.":"Impossible d'obtenir la liste du contenu de la chaîne car vous ne disposez pas du droit d'accès à cette chaîne.","Unable to get channels tree. Request timed out.":"Impossible d'obtenir la liste des chaînes. Délai d'attente de la requête écoulé.","Unable to get media information because you cannot access to this media.":"Impossible d'obtenir les informations sur le média car vous ne pouvez pas accéder à ce média.","Unable to get media information. Request timed out.":"Impossible d'obtenir les informations sur le média. Délai d'attente de la requête écoulé.","Unable to get search's results content because you cannot access to this channel.":"Impossible d'obtenir les résultats de la recherche car vous ne disposez pas du droit d'accès à cette chaîne.",unspecified:"non spécifié",Unspecified:"Non spécifié","Use channel default sorting":"Utiliser le tri par défaut des chaînes","Use the input above to search for something.":"Utilisez le champ de texte ci dessus pour rechercher du contenu.",video:"vidéo","video(s)":"vidéo(s)",videos:"vidéos",Videos:"Vidéos","Views last month":"Vues ce mois",Views:"Vues",views:"vues",yes:"oui",selected:"sélectionné","You are not allowed to have a personnal channel.":"Vous n'avez pas la permission de disposer d'une chaîne personnelle.","You are not logged in or your session has expired. Please login and retry.":"Vous n'êtes pas connecté ou votre session a expiré. Veuillez vous reconnecter puis réessayez."},"fr");