function MSAPIClient(e){this.base_url="",this.use_proxy=!1,this.extra_data=null,this.defaults_errors_messages={401:utils.translate("You are not logged in or your session has expired. Please login and retry."),403:utils.translate("Access denied."),404:utils.translate("Item not found."),500:utils.translate("An internal server error occurred. An email has been sent to the support team."),timeout:utils.translate("The connection timed out. Please retry later."),unreachable:utils.translate("The server cannot be reached.")},this.calls={ping:{method:"GET",url:"/api/v2/"},search:{method:"GET",url:"/api/v2/search/",errors:{403:utils.translate("Unable to get search's results content because you cannot access to this channel."),404:utils.translate("Requested channel does not exist.")}},get_latest_content:{method:"GET",url:"/api/v2/latest/"},get_channels_list:{method:"GET",url:"/api/v2/channels/"},get_channels_content:{method:"GET",url:"/api/v2/channels/content/",errors:{403:utils.translate("Unable to get channel content because you cannot access to this channel."),404:utils.translate("Requested channel does not exist.")}},get_channels:{method:"GET",url:"/api/v2/channels/get/",errors:{403:utils.translate("Unable to get channel information because you cannot access to this channel."),404:utils.translate("Requested channel does not exist.")}},get_channels_tree:{method:"GET",url:"/api/v2/channels/tree/",errors:{403:utils.translate("Unable to get channels tree because you cannot access to this channel."),404:utils.translate("Requested channel does not exist.")}},get_channels_path:{method:"GET",url:"/api/v2/channels/path/",errors:{403:utils.translate("Unable to get channels path because you cannot access to this channel."),404:utils.translate("Requested channel does not exist.")}},get_channels_personal:{method:"GET",url:"/api/v2/channels/personal/"},get_medias_list:{method:"GET",url:"/api/v2/medias/"},get_medias:{method:"GET",url:"/api/v2/medias/get/",errors:{403:utils.translate("Unable to get media information because you cannot access to this media."),404:utils.translate("Media does not exist.")}},add_medias:{method:"POST",url:"/api/v2/medias/add/"},medias_resources_check:{method:"POST",url:"/api/v2/medias/resources-check/"},medias_trimming_child_init:{method:"POST",url:"/api/v2/medias/trimming-child-init/"},medias_get_upload_config:{method:"GET",url:"/api/v2/medias/get-upload-config/"},get_lives_list:{method:"GET",url:"/api/v2/lives/"},prepare_lives:{method:"POST",url:"/api/v2/lives/prepare/"},start_lives:{method:"POST",url:"/api/v2/lives/start/"},stop_lives:{method:"POST",url:"/api/v2/lives/stop/",errors:{403:utils.translate("You are not allowed to perform this action."),404:utils.translate("Media does not exist.")}},lives_change_slides:{method:"POST",url:"/api/v2/lives/change-slide/"},lives_change_status:{method:"POST",url:"/api/v2/lives/change-status/"},lives_get_viewers:{method:"GET",url:"/api/v2/lives/get-viewers/"},list_media_annotations:{method:"GET",url:"/api/v2/annotations/list/"},list_media_user_annotations:{method:"GET",url:"/api/v2/annotations/list/moderate/"},list_annotations_types:{method:"GET",url:"/api/v2/annotations/types/list/"},vote_for_annotation:{method:"POST",url:"/api/v2/annotations/vote/"},post_annotation:{method:"POST",url:"/api/v2/annotations/post/"},validate_annotation:{method:"POST",url:"/api/v2/annotations/validate/"},unvalidate_annotation:{method:"POST",url:"/api/v2/annotations/unvalidate/"},delete_annotation:{method:"POST",url:"/api/v2/annotations/delete/"},list_media_slides:{method:"GET",url:"/api/v2/annotations/slides/list/"},list_media_resources:{method:"GET",url:"/api/v2/annotations/resources/list/"},list_media_chapters:{method:"GET",url:"/api/v2/annotations/chapters/list/"},list_media_activities:{method:"GET",url:"/api/v2/annotations/activities/list/"},email_notification:{method:"POST",url:"/api/v2/annotations/notification/"},search_annotations:{method:"GET",url:"/api/v2/annotations/search/"},list_categories:{method:"GET",url:"/api/v2/categories/"}},this.configure(e)}function MSBrowserChannels(e){this.browser=null,this.display_itunes_rss=!1,this.current_channel_oid="0",this.$menu=null,this.$content=null,this.tree_manager=null,this.order="default",this.last_response=null,utils.setup_class(this,e,["browser","display_itunes_rss","current_channel_oid"]),this.init_options=e||{}}function MSBrowserLatest(e){this.browser=null,this.$menu=null,this.$content=null,this.$place=null,this.last_response=null,this.more=!1,this.start_date="",this.date_label="",this.$section=null,this.can_add_channel=!1,this.can_add_video=!1,utils.setup_class(this,e,["browser"]),this.init_options=e||{}}function MSBrowserSearch(e){var t,s;if(this.browser=null,this.$menu=null,this.$content=null,this.last_response=null,this.search_in_fields=[{name:"in_title",label:"titles",initial:!0,items:null},{name:"in_description",label:"descriptions",initial:!1,items:null},{name:"in_keywords",label:"keywords",initial:!0,items:null},{name:"in_speaker",label:"speakers",initial:!0,items:"vlp"},{name:"in_license",label:"licenses",initial:!1,items:"vlp"},{name:"in_company",label:"companies",initial:!1,items:"vlp"},{name:"in_location",label:"locations",initial:!1,items:"vlp"},{name:"in_categories",label:"categories",initial:!1,items:"vlp"},{name:"in_annotations",label:"comments, slides, ...",initial:!1,items:"vlp"},{name:"in_photos",label:"photos",initial:!1,items:"p"},{name:"in_extref",label:"external references",initial:!0,items:null}],e.default_search_in)for(t=0;t<this.search_in_fields.length;t++)s=this.search_in_fields[t].name.replace("in_",""),-1!==e.default_search_in.indexOf(s)?this.search_in_fields[t].initial=!0:this.search_in_fields[t].initial=!1;this.search_for_fields=[{name:"for_channels",label:"channels",initial:!0,items:"c"},{name:"for_videos",label:"videos",initial:!0,items:"v"},{name:"for_lives",label:"live streams",initial:!0,items:"l"},{name:"for_photos",label:"photos groups",initial:!0,items:"p"}],utils.setup_class(this,e,["browser"]),this.init_options=e||{}}function MSBrowser(e){if(this.title="",this.place=null,this.selectable_content="cvlp",this.displayable_content="cvlp",this.filter_editable=null,this.filter_validated=null,this.filter_speaker=null,this.filter_categories=[],this.filter_no_categories=!1,this.parent_selection_oid=null,this.initial_oid=null,this.initial_state=null,this.on_pick=null,this.hide_header=!1,this.btn_class="",this.msapi=null,this.tree_manager=!0,this.display_types_icons=!1,this.display_itunes_rss=!0,this.use_overlay=!0,this.pick_mode=!0,this.iframe_mode=!1,this.lti_mode=!1,this.links_url_params="",this.links_target="",this.$widget=null,this.$menu=null,this.$main=null,this.overlay=null,this.catalog={},this.display_as_thumbnails=!1,this.displayed="channels",this.current_selection=null,this.site_settings_categories=[],this.url_login="/login/",this.url_channels="/channels/",this.url_latest="/latest/",this.url_search="/search/",this.url_post_link="/lti/post-link/",this.default_search_in=[],utils.setup_class(this,e,["title","place","msapi","selectable_content","displayable_content","filter_editable","filter_validated","filter_speaker","parent_selection_oid","initial_oid","initial_state","on_pick","hide_header","btn_class","tree_manager","display_types_icons","display_itunes_rss","default_search_in"]),this.msapi||(this.msapi=new MSAPIClient(e)),this.init_options=e||{},this.use_overlay=!this.place,!this.use_overlay){var t=this;$(document).ready(function(){t.init()})}}function MSTreeManager(e){if(this.$place=null,this.msapi=null,this.display_root=!1,this.display_personal=!1,this.auto_init=!0,this.current_channel_oid="0",this.on_change=null,this.on_data_retrieved=null,this.on_tree_loaded=null,this.channels_base_url="/channels/#",this.channels_url_field="slug",this.tree_url="",this.path_url="",this.$widget=null,this.loaded=!1,this.loading=!1,this.content={0:{oid:"0",parent_oid:null}},this.loading_queue={},this.has_personal_channel=!1,this.personal_channel_info=null,utils.setup_class(this,e,["$place","msapi","display_root","display_personal","auto_init","current_channel_oid","on_change","on_data_retrieved","on_tree_loaded","channels_base_url","channels_url_field","tree_url","path_url"]),this.initial_oid=this.current_channel_oid,this.msapi||(this.msapi=new MSAPIClient(e)),this.auto_init){var t=this;$(document).ready(function(){t.init()})}}MSAPIClient.prototype.configure=function(e){e&&("base_url"in e&&(this.base_url=e.base_url),"use_proxy"in e&&(this.use_proxy=e.use_proxy),"extra_data"in e&&(this.extra_data=e.extra_data))},MSAPIClient.prototype.ajax_call=function(e,t,s,i,a,n){var o,l,r,c,d,h=this.calls[e];if(!h)if(1==(o=e.split(":")).length)h={method:"GET",url:o[0]};else{if(2!=o.length)throw new Error("Invalid call or uri.");h={method:o[0],url:o[1]}}if(l=this.base_url,this.use_proxy?t.action=h.url:(this.base_url||(t.local="yes"),l+=h.url),void 0===l||"undefined"===l)throw new Error("No url to call.");if(this.extra_data)for(r in this.extra_data)t[r]=this.extra_data[r];return c=this,d={url:l,method:h.method,data:t,dataType:"json",cache:!1,success:function(e){if(e.success||e.error||(e.error=e.message?e.message:utils.translate("No information about error.")),s)return s(e)},error:function(e,t,i){var a,n="?";return e.status?n=e.status:"error"==t?n="unreachable":"timeout"==t&&(n="timeout"),(a=h.errors&&n in h.errors?h.errors[n]:"")||(a=n in c.defaults_errors_messages?c.defaults_errors_messages[n]:utils.translate("Request failed:")+" "+i),s({success:!1,error:a,error_code:e.status,xhr:e,textStatus:t,thrownError:i})}},(void 0===i||i)&&(d.async=i),a&&(d.processData=!1,d.enctype="multipart/form-data",d.contentType=!1),n&&(d.xhr=n),$.ajax(d)},MSAPIClient.prototype.get_storage_display=function(e){var t,s,i,a="";return null!==e.storage_used&&void 0!==e.storage_used&&(a='<span class="storage-usage">'+utils.get_size_display(e.storage_used),e.storage_quota>0&&(a+=" / "+e.storage_quota+" G"+utils.translate("B"),(t=Math.round(e.storage_used/1e9*100/e.storage_quota))>100&&(t=100),s="",e.storage_warning&&t>e.storage_warning&&(s=" red"),a+='<span class="progress-bar inline-block'+s+'" aria-hidden="true" style="width: 100%; vertical-align: middle;"><span class="progress-level" style="width: '+t+'%"></span><span class="progress-label">'+t+" %</span></span>"),a+="</span>",(i=this.get_available_storage_display(e))&&(a+=" "+i)),a},MSAPIClient.prototype.get_storage_minimal_display=function(e){var t="";return null!==e.storage_used&&void 0!==e.storage_used&&(t='<span class="storage-usage">'+utils.get_size_display(e.storage_used),e.storage_quota>0&&(t+=" / "+e.storage_quota+" G"+utils.translate("B")),t+="</span>"),t},MSAPIClient.prototype.get_available_storage_display=function(e){var t,s,i="";return null!==e.storage_available&&void 0!==e.storage_available&&(t="",e.storage_quota>0&&(s=e.storage_used/1e9*100/e.storage_quota,e.storage_warning&&s>e.storage_warning&&(t=" orange")),i+='<span class="storage-available nowrap">',e.storage_available>0?i+='<span class="'+t+' ">'+utils.translate("Available space:")+" "+utils.get_size_display(e.storage_available)+"</span>":i+='<span class="red">'+utils.translate("No available space")+"</span>",i+=' <button type="button" class="tooltip-button no-padding no-border no-background" aria-describedby="id_storage_help" aria-label="'+utils.translate("help")+'"><i class="fa fa-question-circle fa-fw" aria-hidden="true"></i><span role="tooltip" id="id_storage_help" class="tooltip-hidden-content">'+utils.translate("The storage quota of the parent channels can have an impact on the available space of this channel.")+"</span></button>",i+="</span>"),i},MSBrowserChannels.prototype.get_menu_jq=function(){return'<div id="ms_browser_channels_menu" style="display: none;">',"</div>",this.$menu=$('<div id="ms_browser_channels_menu" style="display: none;"></div>'),this.$menu},MSBrowserChannels.prototype.get_content_jq=function(){var e="";return e+='<div id="ms_browser_channels" class="ms-browser-content" style="display: none;">',this.browser.tree_manager&&(e+='<div class="ms-browser-tree-place ms-channels-tree">',e+='<div><i class="fa fa-spinner fa-spin" aria-hidden="true"></i> '+utils.translate("Loading...")+"</div>",e+="</div>"),e+='<div class="ms-browser-channels-place">',e+='<div class="messages"><div class="message info">'+utils.translate("Select a channel to display its content.")+"</div></div>",e+="</div>",e+="</div>",this.$content=$(e),this.$place=$(".ms-browser-channels-place",this.$content),this.$content},MSBrowserChannels.prototype.refresh_title=function(){var e,t,s;"channels"==this.browser.get_active_tab()&&((e=this.last_response?this.last_response.info:void 0)&&"0"!=e.oid?(t='<span class="item-entry-preview"><img src="'+e.thumb+'" alt="'+utils.escape_html(e.title)+'"/></span>',t+='<span class="channel-titles-place">',s=e.parent_oid&&"0"!=e.parent_oid?e.parent_title:utils.translate("Root"),!this.browser.use_overlay&&s&&(t+='<a class="parent-channel-title" href="#'+(e.parent_slug?e.parent_slug:"")+'"'+(e.parent_language?'lang="'+e.parent_language+'"':"")+">"+utils.escape_html(s)+"</a>"),t+='<span class="channel-title"'+(e.language?'lang="'+e.language+'"':"")+">"+utils.escape_html(e.title)+"</span>",t+="</span>",this.browser.current_selection&&this.browser.current_selection.oid==e.oid&&(t='<span class="selected">'+t+"</span>"),this.browser.set_title(e.title,t)):this.browser.lti_mode?this.browser.set_title(utils.translate("My channel")):this.browser.set_title(utils.translate("Main channels")))},MSBrowserChannels.prototype.on_show=function(){var e,t;this.refresh_title(),this.initialized||(this.initialized=!0,this.default_logo_src=$("#mainlogo .header-logo").attr("src"),this.default_fav_src=$("#favicon_link").attr("src"),e=this,this.browser.tree_manager&&(t={$place:$(".ms-browser-tree-place",this.$content),msapi:this.browser.msapi,display_root:-1!=this.browser.displayable_content.indexOf("c"),display_personal:!0,current_channel_oid:this.current_channel_oid,on_data_retrieved:function(t){e.browser.update_catalog(t)}},this.browser.pick_mode&&(t.on_change=function(t){e.display_channel(t)}),this.tree_manager=new MSTreeManager(t)),this.init_options.initial_state&&this.init_options.initial_state.channel_slug?this.display_channel_by_slug(this.init_options.initial_state.channel_slug):"self"==this.browser.filter_speaker?this.display_personal_channel():this.display_channel(this.current_channel_oid))},MSBrowserChannels.prototype.set_order=function(e){this.order=e||"default",this.refresh_display(!0)},MSBrowserChannels.prototype.display_personal_channel=function(){var e=this;this.personal_channel_oid?e.display_channel(this.personal_channel_oid):this.browser.msapi.ajax_call("get_channels_personal",{},function(t){t.success?(e.personal_channel_oid=t.oid,e.display_channel(t.oid)):403==t.error_code?e._on_channel_error({error:utils.translate("You are not allowed to have a personnal channel.")}):e._on_channel_error(t)})},MSBrowserChannels.prototype.display_channel_by_slug=function(e){var t=this;this.browser.get_info_for_slug(e,!1,!0,function(e){e.success?t.display_channel(e.info.oid):t._on_channel_error(e)})},MSBrowserChannels.prototype.display_channel=function(e){if(this.current_channel_oid=e,this.browser.box_hide_info(),this.initialized)if(this.browser.display_loading(),this.tree_manager&&this.tree_manager.set_active(e),"0"!=e){var t=this;this.browser.get_info_for_oid(e,!0,function(s){t._on_channel_info(s,e)})}else this._on_channel_info(null,e)},MSBrowserChannels.prototype.display_parent=function(){var e,t;this.current_channel_oid&&(e=this.current_channel_oid,t=this.browser.catalog[e]&&this.browser.catalog[e].parent_oid?this.browser.catalog[e].parent_oid:"0",this.display_channel(t))},MSBrowserChannels.prototype._on_channel_error=function(e){var t,s;this.last_response=null,t='<div class="messages">',this.browser.use_overlay||"403"!=e.error_code&&"401"!=e.error_code?t+='<div class="message error">'+e.error+"</div>":(s=this.browser.url_login+"?next="+window.location.pathname+(window.location.hash?window.location.hash.substring(1):""),t+='<div class="item-description">',t+='<div class="message error">'+e.error+"</div>",t+="<p>"+utils.translate("Please login to access this channel")+'<br /> <a href="'+s+'">'+utils.translate("Sign in")+"</a></p>",t+="</div>"),t+="</div>",this.$place.html(t)},MSBrowserChannels.prototype._on_channel_info=function(e,t){var s,i;if(this.current_channel_oid==t){if(e&&!e.success)return this._on_channel_error(e);s={},t&&"0"!=t&&(s.parent_oid=t),this.browser.parent_selection_oid&&(s.parent_selection_oid=this.browser.parent_selection_oid),this.browser.displayable_content&&(s.content=this.browser.displayable_content),null!==this.browser.filter_editable&&(s.editable=this.browser.filter_editable?"yes":"no"),null!==this.browser.filter_validated&&(s.validated=this.browser.filter_validated?"yes":"no"),this.browser.lti_mode||null===this.browser.filter_speaker||(s.speaker=this.browser.filter_speaker),this.browser.filter_no_categories?s.no_categories=!0:this.browser.filter_categories.length>0&&(s.categories=this.browser.filter_categories.join("\n")),s.order_by=this.order,i=this,this.browser.msapi.ajax_call("get_channels_content",s,function(s){e&&(e.info&&(s.info=e.info),e.parent_selectable&&(s.parent_selectable=e.parent_selectable),e.selectable&&(s.selectable=e.selectable)),i._on_channel_content(s,t)})}else this.browser.hide_loading()},MSBrowserChannels.prototype._on_channel_content=function(e,t){var s,i,a,n,o,l,r,c,d,h,_,u,p,b,m,f,g,v,w,y,k;if(this.browser.hide_loading(),this.current_channel_oid==t){if(!e.success)return this._on_channel_error(e);if(this.last_response=e,!this.browser.use_overlay&&this.browser.display_as_thumbnails&&this.browser.box_hide_info(),this.$menu.html(""),"0"!=t?(this.browser.lti_mode&&t==this.personal_channel_oid||(i={oid:e.info.parent_oid?e.info.parent_oid:"0",title:e.info.parent_title?e.info.parent_title:utils.translate("Parent channel"),slug:e.info.parent_slug},e.info.parent_oid&&e.info.parent_slug&&this.browser.update_catalog(i),this.browser.use_overlay?(a=$('<button type="button" class="button '+this.browser.btn_class+' back-button"></button>')).click({obj:this,oid:i.oid},function(e){e.data.obj.display_channel(e.data.oid)}):a=$('<a class="button '+this.browser.btn_class+' back-button" href="'+this.browser.get_button_link(i,"view")+'"></a>'),!this.browser.use_overlay&&$(".navbar .back.button-text").length>0?(a.html('<i class="fa fa-chevron-circle-up fa-fw fa-2x" aria-hidden="true"></i>'),a.attr("title",utils.translate("Parent channel")),a.attr("aria-label",utils.translate("Parent channel")),a.addClass("back").addClass("button-text"),$(".navbar .back.button-text").replaceWith(a)):(a.html('<i class="fa fa-chevron-circle-up" aria-hidden="true"></i> <span class="hidden-below-800">'+utils.translate("Parent channel")+"</span>"),this.$menu.append(a)),this.browser.pick_mode&&(n=this.browser.msapi.get_available_storage_display(e.info))&&(this.$menu.append(n+" "),window.uwlb||$(".tooltip-button",this.$menu).click(function(){$("span",this).toggle()}))),o=-1!=this.browser.selectable_content.indexOf("c")&&(!this.browser.parent_selection_oid||e.selectable),s=this.browser.get_entry_links(e.info,"current",o)):(e.oid="0",s=this.browser.get_entry_links(e,"current",!1),!this.browser.use_overlay&&$(".navbar .back.button-text").length>0&&$(".navbar .back.button-text").attr("href","..")),s&&this.$menu.append(s),this.$place.html(""),this.browser.use_overlay)this.$place.scrollTop(0);else{if("0"!=t&&(l=$('<div class="item-description"></div>'),r=!0,c=e.info.can_edit?this.browser.msapi.get_storage_display(e.info):"",(e.info.views||e.info.comments)&&(d='<div class="'+(e.info.short_description||e.info.display_rss_links||c?"right":"align-right")+' channel-description-stats">',e.info.views&&(d+='<span class="inline-block">'+e.info.views+" "+utils.translate("views"),e.info.views_last_month&&(d+=", "+e.info.views_last_month+" "+utils.translate("this month")),d+="</span>"),e.info.comments&&(d+=' <span class="inline-block">'+e.info.comments+" "+utils.translate("annotations"),e.info.comments_last_month&&(d+=", "+e.info.comments_last_month+" "+utils.translate("this month")),d+="</span>"),d+="</div>",l.append(d),r=!1),e.info.short_description&&(h=$('<div class="channel-description-text">'+e.info.short_description+"</div>"),e.info.short_description!=e.info.description&&(h.addClass("short-desc"),h.click({description:e.info.description},function(e){$(this).html(e.data.description).unbind("click").removeClass("short-desc")})),l.append(h),r=!1),e.info.items_count&&(_=[],e.info.channels_count&&_.push(e.info.channels_count+" "+utils.translate("channel(s)")),e.info.videos_count&&_.push(e.info.videos_count+" "+utils.translate("video(s)")),e.info.lives_count&&_.push(e.info.lives_count+" "+utils.translate("live stream(s)")),e.info.pgroups_count&&_.push(e.info.pgroups_count+" "+utils.translate("photos group(s)")),u='<div class="channel-items-count">'+utils.translate("Channel content:"),u+=" <span>"+utils.escape_html(_.join(", "))+"</span>",u+=' <button type="button" class="tooltip-button no-padding no-border no-background" aria-describedby="id_count_help" aria-label="'+utils.translate("help")+'"><i class="fa fa-question-circle fa-fw" aria-hidden="true"></i><span role="tooltip" id="id_count_help" class="tooltip-hidden-content">'+utils.translate("Sub channels items are included in counts.")+"</span></button>",u+="</div>",l.append(u),window.uwlb||$(".channel-items-count .tooltip-button",l).click(function(){$("span",this).toggle()}),r=!1),c&&(c='<div class="channel-storage-usage">'+utils.translate("Storage usage:")+" "+c+"</div>",l.append(c),window.uwlb||$(".channel-storage-usage .tooltip-button",l).click(function(){$("span",this).toggle()}),r=!1),e.info.display_rss_links&&(p='<div class="channel-description-rss"> ',this.display_itunes_rss?(p+=' <span class="inline-block">'+utils.translate("Subscribe to channel videos RSS:")+"</span>",p+=' <a class="nowrap" href="/channels/'+e.info.oid+'/rss.xml">',p+='<i class="fa fa-rss" aria-hidden="true"></i> '+utils.translate("standard")+"</a>",p+=' <a class="nowrap" href="/channels/'+e.info.oid+'/itunes-video.xml">',p+='<i class="fa fa-apple" aria-hidden="true"></i> '+utils.translate("iTunes")+"</a>",p+=' <a class="nowrap" href="/channels/'+e.info.oid+'/itunes-audio.xml">',p+='<i class="fa fa-apple" aria-hidden="true"></i> '+utils.translate("iTunes (audio only)")+"</a>"):(p+=' <a class="nowrap" href="/channels/'+e.info.oid+'/rss.xml">',p+='<i class="fa fa-rss" aria-hidden="true"></i> '+utils.translate("Subscribe to channel videos RSS")+"</a>"),p+="</div>",l.append(p),r=!1),r||this.$place.append(l)),$("head .csslistlink").remove(),e.info){for(m in b="",e.info.css_list)b+='<link class="csslistlink" rel="stylesheet" type="text/css" href="'+e.info.css_list[m]+'"/>';$("head").append(b)}e.info&&e.info.logo_url?$("#mainlogo .header-logo").attr("src",e.info.logo_url):$("#mainlogo .header-logo").attr("src",this.default_logo_src),e.info&&e.info.favicon_url?$("#favicon_link").attr("href",e.info.favicon_url):$("#favicon_link").attr("href",this.default_fav_src)}f=e.channels?e.channels.length:0,g=e.videos?e.videos.length:0,v=e.live_streams?e.live_streams.length:0,w=e.photos_groups?e.photos_groups.length:0,y=f>0||g>0||v>0||w>0,this.refresh_title(),y?this.browser.display_content(this.$place,e,t,"channels"):(k=-1!=this.browser.selectable_content.indexOf("c")?this.browser.displayable_content.length>1?"This channel contains no sub channels and no media.":"This channel contains no sub channels.":"This channel contains no media.",k=utils.translate(k)+"<br/>",k+=utils.translate("Some contents may still exist in this channel but if it is the case your account is not allowed to see them."),this.$place.append('<div class="messages"><div class="message info">'+k+"</div></div>"))}},MSBrowserChannels.prototype.refresh_display=function(e){e&&this.last_response&&(this.last_response=null),this.last_response?this._on_channel_content(this.last_response,this.current_channel_oid):this.browser.lti_mode?this.display_personal_channel():this.display_channel(this.current_channel_oid)},MSBrowserChannels.prototype.remove=function(e){if(this.current_channel_oid==e){var t=this.browser.catalog[e]&&this.browser.catalog[e].parent_oid?this.browser.catalog[e].parent_oid:"0";!this.browser.pick_mode&&this.browser.catalog[t]&&this.browser.catalog[t].slug?window.location.hash="#"+this.browser.catalog[t].slug:this.display_channel(t)}else this.browser.remove_oid_from_tab(this,e)},MSBrowser.prototype.build_widget=function(){var e,t,s,i,a,n;this.last_overlay_focus=document.activeElement,this.previous_focus=null,"self"==this.filter_speaker?(e=utils.translate("My channel"),s=utils.translate("My media"),t=utils.translate("Search in my media")):(e=utils.translate("Channels"),s=utils.translate("Latest content"),t=utils.translate("Search")),i='<div class="ms-browser ms-browser-container'+(this.use_overlay?" in-overlay":"")+(this.tree_manager?" has-tree":"")+(this.display_types_icons?" show-types-icons":"")+(this.hide_header?" no-header":"")+'">',i+='<div class="ms-browser-header">',i+='<div class="ms-browser-menu">',this.use_overlay?(i+='<button type="button" id="ms_browser_channels_tab" class="ms-browser-tab button '+this.btn_class+'" title="'+e+'" aria-label="'+e+'"><i class="fa fa-folder-open" aria-hidden="true"></i> <span class="hidden-below-800" aria-hidden="true">'+e+"</span></button>",i+='<button type="button" id="ms_browser_latest_tab" class="ms-browser-tab button '+this.btn_class+'" title="'+s+'" aria-label="'+s+'"><i class="fa fa-clock-o" aria-hidden="true"></i> <span class="hidden-below-800" aria-hidden="true">'+s+"</span></button>",i+='<button type="button" id="ms_browser_search_tab" class="ms-browser-tab button '+this.btn_class+'" title="'+t+'" aria-label="'+t+'"><i class="fa fa-search" aria-hidden="true"></i> <span class="hidden-below-800" aria-hidden="true">'+t+"</span></button>"):(i+='<a id="ms_browser_channels_tab" class="ms-browser-tab button '+this.btn_class+'" href="'+this.url_channels+'" title="'+e+'" aria-label="'+e+'"><i class="fa fa-folder-open" aria-hidden="true"></i> <span class="hidden-below-800" aria-hidden="true">'+e+"</span></a>",i+='<a id="ms_browser_latest_tab" class="ms-browser-tab button '+this.btn_class+'" href="'+this.url_latest+'" title="'+s+'" aria-label="'+s+'"><i class="fa fa-clock-o" aria-hidden="true"></i> <span class="hidden-below-800" aria-hidden="true">'+s+"</span></a>",i+='<a id="ms_browser_search_tab" class="ms-browser-tab button '+this.btn_class+'" href="'+this.url_search+'" title="'+t+'" aria-label="'+t+'"><i class="fa fa-search" aria-hidden="true"></i> <span class="hidden-below-800" aria-hidden="true">'+t+"</span></a>"),i+="</div>",i+='<h2 class="ms-browser-title"></h2>',i+="</div>",i+='<div class="ms-browser-bar">',i+="</div>",i+='<div class="ms-browser-main ms-items">',i+='<div class="ms-browser-clear"></div>',i+='<div class="ms-browser-loading"><div><i class="fa fa-spinner fa-spin" aria-hidden="true"></i> '+utils.translate("Loading...")+"</div></div>",i+='<div class="ms-browser-message"><div></div></div>',i+="</div>",i+="</div>",this.$widget=$(i),!this.use_overlay&&$("nav .buttons-left").length>0?((n=$("nav .buttons-left")).addClass("ms-browser"),this.hide_header&&n.addClass("no-header"),n.append(this.get_top_menu_jq()),(a=$("#commands_place")).addClass("ms-browser"),this.hide_header&&a.addClass("no-header"),a.addClass("ms-browser-dropdown-right")):((n=$(".ms-browser-header",this.$widget)).addClass("ms-browser-dropdown-right"),n.prepend(this.get_top_menu_jq()),(a=$(".ms-browser-bar",this.$widget)).addClass("ms-browser-dropdown-right")),a.append(this.latest.get_menu_jq()),a.append(this.channels.get_menu_jq()),a.append(this.search.get_menu_jq()),this.$main=$(".ms-browser-main",this.$widget),this.$main.append(this.latest.get_content_jq()),this.$main.append(this.channels.get_content_jq()),this.$main.append(this.search.get_content_jq()),this.$main.append('<div class="ms-browser-clear"></div>'),this.$menu=$(".ms-browser-menu",this.$widget),this.place&&$(this.place).html(this.$widget),$("#ms_browser_channels_tab",this.$menu).click({obj:this},function(e){return e.data.obj.change_tab("channels"),!1}),$("#ms_browser_latest_tab",this.$menu).click({obj:this},function(e){return e.data.obj.change_tab("latest"),!1}),$("#ms_browser_search_tab",this.$menu).click({obj:this},function(e){return e.data.obj.change_tab("search"),!1})},MSBrowser.prototype.get_top_menu_jq=function(){var e,t,s,i,a=[{default:utils.translate("Use channel default sorting")},{"creation_date-desc":utils.translate("Creation date, descending")},{"creation_date-asc":utils.translate("Creation date, ascending")},{"add_date-desc":utils.translate("Add date, descending")},{"add_date-asc":utils.translate("Add date, ascending")},{"title-desc":utils.translate("Title, descending")},{"title-asc":utils.translate("Title, ascending")},{"comments-desc":utils.translate("Number of annotations, descending")},{"comments-asc":utils.translate("Number of annotations, ascending")},{"views-desc":utils.translate("Number of views, descending")},{"views-asc":utils.translate("Number of views, ascending")}],n='<div class="ms-browser-top-buttons">';for(e in n+='<div class="ms-browser-dropdown" id="ms_browser_display_dropdown">',n+='<button aria-controls="ms_browser_display_dropdow_menu" aria-expanded="false" type="button" title="'+utils.translate("Display")+'" class="button ms-browser-dropdown-button '+this.btn_class+'"><i class="fa fa-tv" aria-hidden="true"></i> <span class="hidden-below-1280">'+utils.translate("Display")+' </span><i class="fa fa-angle-down" aria-hidden="true"></i></button>',n+='<div class="ms-browser-dropdown-menu" id="ms_browser_display_dropdow_menu">',n+="<div><h4>"+utils.translate("Display mode:")+"</h4>",n+='<button type="button" class="button '+(this.display_as_thumbnails?"":"active")+'" id="ms_browser_display_as_list" title="'+utils.translate("list")+(this.display_as_thumbnails?"":" ("+utils.translate("selected setting")+")")+'">'+utils.translate("list")+"</button>",n+='<button type="button" class="button '+(this.display_as_thumbnails?"active":"")+'" id="ms_browser_display_as_thumbnails" title="'+utils.translate("thumbnails")+(this.display_as_thumbnails?" ("+utils.translate("selected setting")+")":"")+'">'+utils.translate("thumbnails")+"</button><br/>",n+='<input id="ms_browser_display_types_icons" type="checkbox" '+(this.display_types_icons?'checked="checked"':"")+">",n+=' <label for="ms_browser_display_types_icons">'+utils.translate("display items type icons")+"</label></div>",n+='<div class="ms-browser-channel-order"><h4><label for="ms_browser_order_channel">'+utils.translate("Sort by:")+"</label></h4>",n+=' <select id="ms_browser_order_channel">',a)for(t in a[e])n+='<option value="'+t+'">'+a[e][t]+"</option>";n+="</select></div>",s='<option value="">'+utils.translate("unspecified")+"</option>",s+='<option value="yes">'+utils.translate("yes")+"</option>",s+='<option value="no">'+utils.translate("no")+"</option>",n+='<div class="ms-browser-filters"><h4>'+utils.translate("Filters:")+"</h4>",n+=' <form id="ms_browser_filters_form">',n+=' <label for="ms_browser_filter_editable">'+utils.translate("Editable:")+"</label>",n+=' <select id="ms_browser_filter_editable">'+s+"</select>",(this.displayable_content.length>1||"c"!=this.displayable_content)&&(n+=" <br/>",n+=' <label for="ms_browser_filter_validated">'+utils.translate("Published:")+"</label>",n+=' <select id="ms_browser_filter_validated">'+s+"</select>","self"!=this.filter_speaker&&(n+=" <br/>",n+=' <label for="ms_browser_filter_speaker">'+utils.translate("Speaker:")+"</label>",n+=' <input type="text" id="ms_browser_filter_speaker" value="'+(this.filter_speaker?this.filter_speaker:"")+'"/>',n+=' <button type="submit" class="button">'+utils.translate("Ok")+"</button>")),n+=" </form>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",this.$top_menu=$(n),i=$("#ms_browser_display_dropdown",this.$top_menu),this.setup_dropdown(i),$("#ms_browser_display_as_list",i).click({obj:this,$dropdown:i},function(e){e.data.obj.set_display_as_list()}),$("#ms_browser_display_as_thumbnails",i).click({obj:this,$dropdown:i},function(e){e.data.obj.set_display_as_thumbnails()}),$("#ms_browser_display_types_icons",i).change({obj:this,$dropdown:i},function(e){e.data.obj.set_display_types_icons(this.checked)}),$("#ms_browser_order_channel",i).change({obj:this,$dropdown:i},function(e){e.data.obj.channels.set_order($(this).val())}),$("#ms_browser_filters_form select",i).change({obj:this,$dropdown:i},function(e){$("#ms_browser_filters_form",e.data.$dropdown).submit()}),$("#ms_browser_filters_form",i).submit({obj:this,$dropdown:i},function(e){return e.data.obj.on_filters_submit($(this)),!1});try{this.focus_was_in_dropdown=!1,window.addEventListener("blur",function(){this.check_focus_dropdown()}.bind(this),!0),window.addEventListener("focus",function(){this.check_focus_dropdown()}.bind(this),!0)}catch(e){console.error("Failed to listen to focus changes: "+e)}return this.$top_menu},MSBrowser.prototype.set_title=function(e,t){if(t||(t=e),!this.use_overlay&&$("#global .main-title h1").length>0?($("#global .main-title h1").html(t),$("#global .main-title h1").attr("tabindex","-1"),$("#global .main-title h1").focus()):$(".ms-browser-title",this.$widget).html(t),!this.use_overlay&&document.title){if(!this.document_tilte_suffix){var s=document.title.indexOf(" - ");this.document_tilte_suffix=-1!=s?document.title.substring(s):" - MediaServer"}document.title=e+this.document_tilte_suffix}},MSBrowser.prototype.setup_dropdown=function(e){$(".ms-browser-dropdown-button",e).click({$dropdown:e},function(e){var t=$(".ms-browser-dropdown-button",e.data.$dropdown),s=$(".ms-browser-dropdown-menu",e.data.$dropdown);s.attr("tabindex","-1"),t.hasClass("active")?(t.removeClass("active"),t.attr("aria-expanded",!1),s.removeClass("active")):(t.addClass("active"),t.attr("aria-expanded",!0),s.addClass("active"))}),$(document).click({$dropdown:e},function(e){var t=$(".ms-browser-dropdown-button",e.data.$dropdown),s=$(".ms-browser-dropdown-menu",e.data.$dropdown);!t.hasClass("active")||s.is(e.target)||0!==s.has(e.target).length||t.is(e.target)||0!==t.has(e.target).length||(t.removeClass("active"),t.attr("aria-expanded",!1),s.removeClass("active"))})},MSBrowser.prototype.close_dropdown=function(e){var t=$(".ms-browser-dropdown-button",e),s=$(".ms-browser-dropdown-menu",e);t.hasClass("active")&&(t.removeClass("active"),t.attr("aria-expanded",!1),s.removeClass("active"))},MSBrowser.prototype.check_focus_dropdown=function(){var e,t;if(document.activeElement&&document.activeElement!=document.body){for(e=!1,t=document.activeElement;t;){if(t.className&&-1!=t.className.indexOf("ms-browser-dropdown-menu")){e=!0,this.focus_was_in_dropdown=!0;break}t=t.parentNode}!e&&this.focus_was_in_dropdown&&(this.focus_was_in_dropdown=!1,$(".ms-browser-dropdown-button.active").removeClass("active").attr("aria-expanded",!1),$(".ms-browser-dropdown-menu.active").removeClass("active"))}},MSBrowser.prototype.on_filters_submit=function(e){var t,s,i,a,n=[{type:"choice",id:"ms_browser_filter_editable",name:"filter_editable"},{type:"choice",id:"ms_browser_filter_validated",name:"filter_validated"}];for("self"!=this.filter_speaker&&n.push({type:"text",id:"ms_browser_filter_speaker",name:"filter_speaker"}),t=!1,s=0;s<n.length;s++)if((i=$("#"+n[s].id,e)).length>0){if(a=i.val(),"choice"==n[s].type)switch(a){case"yes":a=!0;break;case"no":a=!1;break;default:a=null}this[n[s].name]!==a&&(this[n[s].name]=a,t=!0)}t&&(this.channels.refresh_display(!0),this.latest.refresh_display(!0),this.search.refresh_display(!0))},MSBrowser.prototype.set_display_as_list=function(){var e=$("#ms_browser_display_as_thumbnails",this.$top_menu),t=$("#ms_browser_display_as_list",this.$top_menu);t.hasClass("active")||(this.display_as_thumbnails=!1,e.removeClass("active").attr("title",e.text()),t.addClass("active").attr("title",t.text()+" ("+utils.translate("selected setting")+")"),this.use_overlay||$("#global").addClass("max-width-1200"),utils.set_cookie("catalog-display_mode","list"),this.channels.refresh_display(),this.latest.refresh_display(),this.search.refresh_display())},MSBrowser.prototype.set_display_as_thumbnails=function(){var e=$("#ms_browser_display_as_thumbnails",this.$top_menu),t=$("#ms_browser_display_as_list",this.$top_menu);e.hasClass("active")||(this.display_as_thumbnails=!0,t.removeClass("active").attr("title",t.text()),e.addClass("active").attr("title",e.text()+" ("+utils.translate("selected setting")+")"),this.use_overlay||$("#global").removeClass("max-width-1200"),utils.set_cookie("catalog-display_mode","thumbnail"),this.channels.refresh_display(),this.latest.refresh_display(),this.search.refresh_display())},MSBrowser.prototype.set_display_types_icons=function(e){this.display_types_icons=e,e?this.$widget.addClass("show-types-icons"):this.$widget.removeClass("show-types-icons"),utils.set_cookie("catalog-display_types_icons",e?"yes":"no")},MSBrowser.prototype.get_active_tab=function(){var e=$(".ms-browser-tab.active",this.$menu),t=e.length>0?e.attr("id").replace(/_tab/g,"").replace(/ms_browser_/g,""):null;return t||this.pick_mode||($(".ms-browser").hasClass("channels")?t="channels":$(".ms-browser").hasClass("latest")?t="latest":$(".ms-browser").hasClass("search")&&(t="search")),t},MSBrowser.prototype.change_tab=function(e,t){var s,i=this.get_active_tab();i!=e&&(i&&this[i]&&($(".ms-browser").removeClass(i),$("#ms_browser_"+i+"_tab",this.$menu).removeClass("active").attr("title",$("#ms_browser_"+i+"_tab",this.$menu).text()),this[i].$menu.css("display","none"),this[i].$content.css("display","none")),$(".ms-browser").addClass(e),$("#ms_browser_"+e+"_tab",this.$menu).addClass("active").attr("title",$("#ms_browser_"+e+"_tab",this.$menu).text()+" ("+utils.translate("selected tab")+")"),this[e]&&(this[e].$menu.css("display",""),this[e].$content.css("display",""),this[e].on_show()),"channels"==e?$(".ms-browser-channel-order",this.$top_menu).css("display",""):$(".ms-browser-channel-order",this.$top_menu).css("display","none"),this.use_overlay||t||(s="search"==e?this.url_search:"latest"==e?this.url_latest:this.url_channels+window.location.hash,window.history.pushState({ms_tab:e},e,s)))},MSBrowser.prototype.display_loading=function(){if(isNaN(this.loading_count)?this.loading_count=1:this.loading_count++,!this.loading_timeout){var e=this;this.loading_timeout=setTimeout(function(){$(".ms-browser-loading",e.$widget).css("display","block"),e.loading_timeout=null},500)}},MSBrowser.prototype.hide_loading=function(){this.loading_count&&this.loading_count--,isNaN(this.loading_count)||this.loading_count>0||(this.loading_timeout&&(clearTimeout(this.loading_timeout),this.loading_timeout=null),$(".ms-browser-loading",this.$widget).css("display",""))},MSBrowser.prototype.display_content=function(e,t,s,i){var a,n,o,l=this.pick_mode?"h3":"h2",r='<ul class="ms-browser-section"></ul>';if(t.channels&&t.channels.length>0){for(n=-1!=this.selectable_content.indexOf("c"),s&&"0"!=s?e.append("<"+l+">"+utils.translate("Sub channels")+"</"+l+">"):"search"==i&&e.append("<"+l+">"+utils.translate("Channels")+"</"+l+">"),o=$(r),a=0;a<t.channels.length;a++)void 0===t.channels[a].parent_oid&&s&&(t.channels[a].parent_oid=s),o.append(this.get_content_entry("channel",t.channels[a],n,i));e.append(o)}if(t.live_streams&&t.live_streams.length>0){for(n=-1!=this.selectable_content.indexOf("l"),e.append("<"+l+">"+utils.translate("Live streams")+"</"+l+">"),o=$(r),a=0;a<t.live_streams.length;a++)o.append(this.get_content_entry("live",t.live_streams[a],n,i));e.append(o)}if(t.videos&&t.videos.length>0){for(n=-1!=this.selectable_content.indexOf("v"),e.append("<"+l+">"+utils.translate("Videos")+"</"+l+">"),o=$(r),a=0;a<t.videos.length;a++)o.append(this.get_content_entry("video",t.videos[a],n,i));e.append(o)}if(t.photos_groups&&t.photos_groups.length>0){for(n=-1!=this.selectable_content.indexOf("p"),e.append("<"+l+">"+utils.translate("Photos groups")+"</"+l+">"),o=$(r),a=0;a<t.photos_groups.length;a++)o.append(this.get_content_entry("photos",t.photos_groups[a],n,i));e.append(o)}},MSBrowser.prototype.get_content_entry=function(e,t,s,i){var a,n,o,l,r,c,d;return this.update_catalog(t),a=t.oid,n=s&&(!this.parent_selection_oid||t.selectable),o=this.pick_mode&&(n||"channel"==e),l=null,(l=$('<li class="item-entry item-type-'+e+" item-entry-"+a+'"></li>')).attr("id","item_entry_"+a+"_"+i),l.addClass(this.display_as_thumbnails?"thumbnail":"list"),this.current_selection&&this.current_selection.oid==a&&(l.addClass("selected"),l.attr("title",t.title+" "+utils.translate("selected"))),n&&l.addClass("selectable"),o&&l.addClass("clickable"),t.extra_class&&l.addClass(t.extra_class),r=this._get_entry_block_html(t,e,o,i),this.display_as_thumbnails&&!this.pick_mode&&(r+='<div class="item-entry-buttons">',r+='<button type="button" class="item-entry-info" title="'+utils.translate("Open information panel")+'"><i class="fa fa-info" aria-hidden="true"></i></button>',t.can_edit&&(r+='<a title="'+utils.translate("Edit")+'" href="'+this.get_button_link(t,"edit")+'"'+this.links_target+'><i class="fa fa-pencil" aria-hidden="true"></i></a>'),r+='<div class="overlay-info ms-items" id="item_entry_'+a+"_"+i+'_info" style="display: none;" role="dialog" tabindex="-1" aria-labelledby="item_entry_'+t.oid+"_"+i+'_info_title" aria-modal="true"></div>',r+="</div>"),c=$(r),this._set_on_click_entry_block(c,a,e,t,n),l.append(c),this.display_as_thumbnails?this._set_thumbnail_info_box_html(e,n,a,l,t,i):(d=this.get_entry_links(t,e,n))&&l.append(d),$(".item-entry-link",l).focus(function(){$(".item-entry").removeClass("focus"),$(this).parent().addClass("focus")}),l},MSBrowser.prototype._get_entry_block_html=function(e,t,s,i){var a,n,o,l,r,c,d,h,_,u,p="span",b="",m=' tabindex="0" role="button"';if(this.use_overlay||!e.slug||this.pick_mode&&"channel"!=t||(p="a",m="",b=' href="'+this.get_button_link(e,"view")+'"',"channel"!=t&&(b+=this.links_target)),a="<"+p+b+m+' class="item-entry-link"'+(s&&"channel"!=t?' title="'+utils.translate("Click to select this media")+'"':"")+">",n='<span class="item-entry-preview">',n+='<span class="item-entry-preview-aligner"></span>',e.thumb&&(n+='<img src="'+e.thumb+'" alt=""'+(e.language?' lang="'+e.language+'"':"")+"/>"),this.pick_mode||"channel"==t||(n+='<b class="item-entry-preview-play"><i class="fa fa-play fa-4x" aria-hidden="true"></i></b>'),a+=n+="</span>",o='<span class="item-entry-content">',l='<span class="item-entry-top-bar">',"channel"==t?l+='<span class="item-entry-layout layout-channel" title="'+utils.translate("This item is a channel")+'"></span>':"photos"==t?l+='<span class="item-entry-layout layout-pgroup" title="'+utils.translate("This item is a photos group")+'"></span>':(l+='<span class="item-entry-layout ',e.layout?l+="layout-"+e.layout:l+="layout-video",l+='" title="',r=utils.translate("live"==t?"This item is a live stream":"This item is a video"),e.layout&&("composition"==e.layout?r+=" ("+utils.translate("dynamic RichMedia")+")":"webinar"==e.layout?r+=" ("+utils.translate("classic RichMedia")+")":r+=" ("+e.layout.replace(/_/," ")+")"),l+=r,l+='"><span class="sr-only">'+r+"</span></span>"),e.can_edit&&("channel"==t?e.unlisted&&(l+='<span class="item-entry-unlisted" title="'+utils.translate("This channel is unlisted")+'"><span class="sr-only">'+utils.translate("This channel is unlisted")+"</span></span>"):(e.validated?e.unlisted?l+='<span class="item-entry-unlisted" title="'+utils.translate("This media is published and unlisted")+'"><span class="sr-only">'+utils.translate("This media is published and unlisted")+"</span></span>":l+='<span class="item-entry-published" title="'+utils.translate("This media is published")+'"><span class="sr-only">'+utils.translate("This media is published")+"</span></span>":l+='<span class="item-entry-notpublished" title="'+utils.translate("This media is not published")+'"><span class="sr-only">'+utils.translate("This media is not published")+"</span></span>","video"!=t||e.ready||(l+='<span class="item-entry-notready" title="'+utils.translate("This video is not ready")+'"><span class="sr-only">'+utils.translate("This video is not ready")+"</span></span>"))),e.duration&&(l+='<span class="item-entry-duration">'+e.duration+"</span>"),this.display_as_thumbnails||(l+='<span class="item-entry-title"'+(e.language?' lang="'+e.language+'"':"")+">"+utils.escape_html(e.title)+"</span>"),o+=l+="</span>",c='<span class="item-entry-bottom-bar">',this.display_as_thumbnails?c+='<span class="item-entry-title"'+(e.language?' lang="'+e.language+'"':"")+">"+utils.escape_html(e.title)+"</span>":(e.creation&&(c+='<span class="item-entry-date">'+utils.translate("Created on")+" "+utils.get_date_display(e.creation)+"</span>"),e.short_description&&(c+='<span class="item-entry-description">'+$("<span>"+e.short_description+"</span>").text()+"</span>"),e.views&&(c+='<span class="item-entry-views">'+e.views+" "+utils.translate("views"),e.views_last_month&&(c+=", "+e.views_last_month+" "+utils.translate("this month")),c+="</span>"),e.can_edit&&null!==e.storage_used&&void 0!==e.storage_used&&(d=this.msapi.get_storage_minimal_display(e))&&(c+='<span class="item-entry-storage">'+utils.translate("Storage usage:")+" "+d+"</span>"),"latest"==i&&(c+='<span class="item-entry-type">'+utils.translate("Type:")+" "+utils.translate(t)+"</span>",e.add_date&&(c+='<span class="item-entry-date">'+utils.translate("Added on")+" "+utils.get_date_display(e.add_date)+"</span>"),e.parent_title&&(c+='<span class="item-entry-parent">'+utils.translate("Parent channel:")+" "+e.parent_title+"</span>"))),o+=c+="</span>",a+=o+="</span>",a+="</"+p+">",!this.display_as_thumbnails&&!this.pick_mode&&"search"==i&&(e.annotations||e.photos)){if(a+='<span class="item-entry-extra">',e.annotations){for(a+="<span>"+utils.translate("Matching annotations:")+"</span><ul>",h=0;h<e.annotations.length;h++)_=e.annotations[h],a+='<li><a href="'+this.get_button_link(e,"view")+"#start="+_.time+'&autoplay"'+this.links_target+">",_.title&&(a+=_.title),a+=" ("+_.time_display+") ",a+="</a></li>";a+="</ul>"}if(e.photos){for(a+="<span>"+utils.translate("Matching photos:")+"</span><ul>",h=0;h<e.photos.length;h++)u=e.photos[h],a+='<li><a href="'+this.get_button_link(e,"view")+"#"+u.index+'"'+this.links_target+">",u.title&&(a+=u.title),a+=" (#"+u.index+") ",a+="</a></li>";a+="</ul>"}a+="</span>"}return a},MSBrowser.prototype._set_on_click_entry_block=function(e,t,s,i,a){this.pick_mode?("channel"==s||"parent"==s?e.click({obj:this,oid:t},function(e){e.data.obj.channels.display_channel(e.data.oid),e.data.obj.change_tab("channels"),utils.focus_first_descendant($("#ms_browser_channels .ms-browser-channels-place")[0])}):a&&e.click({obj:this,oid:t},function(e){e.data.obj.pick(e.data.oid)}),e.keydown(function(e){"32"!=e.which&&"13"!=e.which||(e.preventDefault(),e.stopPropagation(),$(this).trigger("click"))})):i.can_delete&&$(".item-entry-pick-delete-media",e).click({obj:this,oid:t},function(e){e.data.obj.pick(e.data.oid,"delete")})},MSBrowser.prototype.get_entry_links=function(e,t,s){var i,a,n,o,l,r,c="";return this.pick_mode?s&&(a=(i=this.current_selection&&this.current_selection.oid==e.oid)?"fa-check-circle":"fa-check",n="channel"==t||"current"==t?i?utils.translate("This channel is selected"):utils.translate("Select this channel"):i?utils.translate("This media is selected"):utils.translate("Select this media"),c+='<button type="button" class="'+this.btn_class+' button main item-entry-pick"><i class="fa '+a+'" aria-hidden="true"></i> <span class="hidden-below-800">'+utils.translate(n)+"</span></button>"):"current"==t?(e.can_edit&&(c+='<a title="'+utils.translate("Edit")+'" class="'+this.btn_class+' button default item-entry-pick item-entry-pick-edit-media" href="'+this.get_button_link(e,"edit")+'"'+this.links_target+'><i class="fa fa-pencil" aria-hidden="true"></i> <span class="hidden-below-800">'+utils.translate("Edit")+"</span></a>",e.can_delete&&(c+='<button title="'+utils.translate("Delete")+'" type="button" class="'+this.btn_class+' button danger item-entry-pick-delete-media"><i class="fa fa-trash" aria-hidden="true"></i> <span class="hidden-below-800">'+utils.translate("Delete")+"</span></button>")),(e.can_add_channel||e.can_add_video)&&(e.can_add_channel&&(o='<i class="fa fa-folder" aria-hidden="true"></i> <i class="fa fa-plus color-green" aria-hidden="true"></i>',c+='<a title="'+utils.translate("Add a sub channel")+'" class="'+this.btn_class+' button item-entry-pick item-entry-pick-add-channel" href="'+this.get_button_link(e,"add_channel")+'"'+this.links_target+">"+o+' <span class="hidden-below-800">'+utils.translate("Add a sub channel")+"</span></a>"),"0"!=e.oid&&e.can_add_video&&(l='<i class="fa fa-film" aria-hidden="true"></i> <i class="fa fa-plus color-green" aria-hidden="true"></i>',c+='<a title="'+utils.translate("Add a video")+'" class="'+this.btn_class+' button item-entry-pick item-entry-pick-add-video" href="'+this.get_button_link(e,"add_video")+'"'+this.links_target+">"+l+' <span class="hidden-below-800">'+utils.translate("Add a video")+"</span></a>"))):("channel"!=t&&this.lti_mode&&(c+='<button type="button" class="'+this.btn_class+' button default item-entry-copy" data-link="'+this.get_button_link(e,"lti",!0)+'"><i class="fa fa-chain" aria-hidden="true"></i> <span class="hidden-below-440">'+utils.translate("Copy LTI link")+"</span></button>"),("channel"!=t&&this.lti_mode||e.can_edit||e.can_delete)&&(c+='<a class="'+this.btn_class+' button default item-entry-pick-view-media" href="'+this.get_button_link(e,"view")+'"'+this.links_target+'><i class="fa fa-eye" aria-hidden="true"></i> <span class="hidden-below-440">'+utils.translate("See")+"</span></a>"),e.can_edit&&(c+='<a class="'+this.btn_class+' button item-entry-pick-edit-media default" href="'+this.get_button_link(e,"edit")+'"'+this.links_target+'><i class="fa fa-pencil" aria-hidden="true"></i> <span class="hidden-below-440">'+utils.translate("Edit")+"</span></a>"),e.can_delete&&(c+='<button type="button" class="'+this.btn_class+' button item-entry-pick-delete-media danger"><i class="fa fa-trash" aria-hidden="true"></i> <span class="hidden-below-440">'+utils.translate("Delete")+"</span></button>")),c?(c='<span class="item-entry-links"><span class="item-entry-links-container">'+c+"</span></span>",r=$(c),"channel"!=t&&"parent"!=t||$(".item-entry-display",r).click({obj:this,item:e},function(e){e.data.obj.pick_mode&&e.data.obj.channels.display_channel(e.data.item.oid)}),s&&$(".item-entry-pick",r).click({obj:this,item:e},function(e){e.data.obj.pick(e.data.item.oid)}),!this.pick_mode&&e.can_delete&&$(".item-entry-pick-delete-media",r).click({obj:this,item:e},function(e){e.data.obj.pick(e.data.item.oid,"delete")}),$(".item-entry-copy",r).length>0&&$(".item-entry-copy",r).click(function(){var e,t,s=$(this),i=s.attr("data-link"),a=$('<input type="text" style="position: absolute; left: -10000px; top: 0;"/>').val(i);$("body").append(a),a.select();try{t=(e=document.execCommand("copy"))?"copied":"cannot copy"}catch(s){e=!1,t="failed to copy",console.log("Failed to copy to clipboard: "+s)}t='<i class="fa '+(e?"fa-check":"fa-warning")+'" aria-hidden="true"></i> '+utils.translate(t),s.append('<span class="copy-msg">'+t+"</span>"),s.addClass("copied"),setTimeout(function(){s.removeClass("copied"),$(".copy-msg",s).remove()},1e3),a.remove()}),r):null},MSBrowser.prototype.get_button_link=function(e,t,s){var i="",a="",n="";if(e&&e.oid&&(n=e.oid[0]),t||n&&""!==n&&"0"!==n||e&&"0"!=e.oid)if("view"==t)e.slug||"0"==e.oid||this.get_info_for_oid(e.oid,!1,function(t){e=t.info}),"0"==n?(i="/channels/",a="#"):"c"==n?(i="/channels/",a="#"+e.slug):("l"==n?i="/lives/"+e.slug+"/":"v"==n?i="/videos/"+e.slug+"/":"p"==n&&(i="/photos/"+e.slug+"/"),i&&this.iframe_mode&&(i+="iframe/"));else if("lti"==t)i="/lti/"+e.oid+"/";else if("edit"==t)i=this.iframe_mode?"/edit/iframe/"+e.oid+"/":"/edit/"+e.oid+"/";else if("add_channel"==t)i="/add-content/channel/?in="+(e&&"0"!=e.oid?e.oid:"root");else{if("add_video"!=t)return console.error("Unrecognized action specified in MSBrowser.prototype.get_button_link call:",e,t,s),"";i="/add-content/",a="#add_media_by_upload",e&&"0"!=e.oid&&(i+="?in="+e.oid)}else i="/channels/",a="#";return s&&(i=window.location.protocol+"//"+window.location.host+i),this.links_url_params&&"lti"!=t&&(i+=(i.indexOf("?")<0?"?":"&")+this.links_url_params),i+a},MSBrowser.prototype._get_thumbnail_info_box_html=function(e,t,s,i){var a,n,o,l,r,c,d='<div><div tabindex="0"></div>';if(d+='<div class="trap-focus">',d+='<div class="overlay-info-title" id="item_entry_'+e.oid+"_"+i+'_info_title" >',d+='<button type="button" class="overlay-info-close button default '+this.btn_class+'" title="'+utils.translate("Hide this window")+'" aria-label="'+utils.translate("Hide this window")+'"><i class="fa fa-close" aria-hidden="true"></i></button>',d+='<h1><a href="'+this.get_button_link(e,"view")+'"'+this.links_target+">"+e.title+"</a></h1>",d+="</div>",d+='<div class="overlay-info-content">',!this.pick_mode&&"search"==i&&(e.annotations||e.photos)){if(e.annotations){for(d+="<div><b>"+utils.translate("Matching annotations:")+"</b></div>",d+="<ul>",a=0;a<e.annotations.length;a++)n=e.annotations[a],d+='<li><a href="'+this.get_button_link(e,"view")+"#start="+n.time+'&autoplay"'+this.links_target+">",n.title&&(d+=n.title),d+=" ("+n.time_display+") ",d+="</a></li>";d+="</ul>"}if(e.photos){for(d+="<div><b>"+utils.translate("Matching photos:")+"</b></div>",d+="<ul>",a=0;a<e.photos.length;a++)o=e.photos[a],d+='<li><a href="'+this.get_button_link(e,"view")+"#"+o.index+'"'+this.links_target+">",o.title&&(d+=o.title),d+=" (#"+o.index+") ",d+="</a></li>";d+="</ul>"}d+="<hr/>"}return d+='<table class="overlay-info-table">',d+='<caption class="sr-only">'+utils.translate("Media information")+"</caption>",e.creation&&"video"==t&&(d+="<tr>",d+='<th scope="row" class="overlay-info-label">'+utils.translate("Recording date")+" :</th>",d+="<td>"+utils.get_date_display(e.creation)+"</td>",d+="</tr>"),e.add_date&&(d+="<tr>",d+='<th scope="row" class="overlay-info-label">'+utils.translate("Publishing date")+" :</th>",d+="<td>"+utils.get_date_display(e.add_date)+"</td>",d+="</tr>"),e.duration&&(d+="<tr>",d+='<th scope="row" class="overlay-info-label">'+utils.translate("Duration")+" :</th>",d+="<td>"+e.duration+"</td>",d+="</tr>"),e.views_last_month&&(d+='<tr><th scope="row" class="overlay-info-label">'+utils.translate("Views last month")+" :</th><td>"+e.views_last_month+"</td></tr>"),e.views&&(d+='<tr><th scope="row" class="overlay-info-label">'+utils.translate("Views")+" :</th><td>"+e.views+"</td></tr>"),e.comments_last_month&&(d+='<tr><th scope="row" class="overlay-info-label">'+utils.translate("Annotations last month")+" :</th><td>"+e.comments_last_month+"</td></tr>"),e.comments&&(d+='<tr><th scope="row" class="overlay-info-label">'+utils.translate("Annotations")+" :</th><td>"+e.comments+"</td></tr>"),e.can_edit&&null!==e.storage_used&&void 0!==e.storage_used&&(l=this.msapi.get_storage_minimal_display(e))&&(d+='<tr><th scope="row" class="overlay-info-label">'+utils.translate("Storage usage")+" :</th><td>"+l+"</td></tr>"),d+="</table>",e.short_description&&(d+="<hr/>",d+='<div class="float-container">'+e.short_description+"</div>"),d+="</div>",d+="</div>",d+='<div tabindex="0"></div></div>',r=$(d),(c=this.get_entry_links(e,t,s))&&$(".overlay-info-content",r).append(c),$(".overlay-info-close",r).click({obj:this},function(e){e.data.obj.box_hide_info()}),$(document).keydown({obj:this},function(t){$("#item_entry_"+e.oid+"_"+i+"_info").length&&27==t.keyCode&&(t.stopImmediatePropagation(),t.data.obj.box_hide_info())}),r},MSBrowser.prototype._set_thumbnail_info_box_html=function(e,t,s,i,a,n){$(".item-entry-info",i).click({obj:this,$entry:i},function(o){var l,r="#"+i.attr("id")+"_info";o.data.obj.previous_focus=this,""===$(r,o.data.$entry).html()?"search"==n?(l=o.data.obj._get_thumbnail_info_box_html(a,e,t,n),$(r,o.data.$entry).append(l),o.data.obj.box_open_info(i)):o.data.obj.get_info_for_oid(s,!0,function(s){var a,l=s.info;o.data.obj.update_catalog(s.info),a=o.data.obj._get_thumbnail_info_box_html(l,e,t,n),$(r,o.data.$entry).append(a),o.data.obj.box_open_info(i)}):o.data.obj.box_open_info(i)})},MSBrowser.prototype.trap_focus=function(e,t){utils.ignore_until_focus_changes||(e.contains(t.target)?this.last_overlay_focus=t.target:(utils.focus_first_descendant(e),this.last_overlay_focus==document.activeElement&&utils.focus_last_descendant(e),this.last_overlay_focus=document.activeElement))},MSBrowser.prototype.box_open_info=function(e){var t,s,i,a,n,o,l;this.box_hide_info(),t="#"+e.attr("id")+"_info",(s=$(t)).hasClass("moved")||s.addClass("moved").detach().appendTo("body"),s.is(":visible")||(i=$(".item-entry-preview",e),a=parseInt(i.offset().top,10)-1,n=parseInt(i.offset().left,10)+i.width(),o="auto",$(window).width()/2-n<0&&(n="auto",o=$(window).width()-parseInt(i.offset().left,10)),s.css("left",n+"px"),s.css("right",o+"px"),s.css("top",a+"px"),$(".item-entry-info",e).addClass("info-displayed"),s.fadeIn("fast"),this.last_overlay_focus=document.activeElement,s.focusin(this.trap_focus.bind(this,$(".trap-focus",s)[0])),utils.focus_first_descendant($(".trap-focus",s)[0]),this.box_click_handler&&$(document).unbind("click",this.box_click_handler),l=this,this.box_click_handler=function(e){$(e.target).closest(t).length||$(e.target).closest(".item-entry-info").length||!$(t).is(":visible")||l.box_hide_info()},$(document).click(this.box_click_handler))},MSBrowser.prototype.box_hide_info=function(){$(".overlay-info:visible").length&&($(".overlay-info:visible").off("focusin"),this.last_overlay_focus=document.activeElement,$(".overlay-info:visible").fadeOut("fast"),$(".item-entry-info.info-displayed").removeClass("info-displayed"),this.previous_focus&&this.previous_focus.focus())},MSBrowser.prototype.display_categories=function(){var e,t,s,i=this;if(this.site_settings_categories.length>0){for(e=' <button type="button" id="open_hidden_categories" class="button">'+utils.translate("Categories")+' <i class="fa fa-angle-down" aria-hidden="true"></i></button>',e+=' <div id="hidden_categories" class="hidden-visibility">',e+=' <label for="filter_no_categories"><input id="filter_no_categories" type="checkbox"/><span>'+utils.translate("Unspecified")+"</span></label><br />",t=0;t<this.site_settings_categories.length;t++)e+=' <label for="'+(s=utils.escape_attr(this.site_settings_categories[t][0]))+'"><input class="checkbox" id="'+s+'" type="checkbox" value="'+s+'"/><span>'+utils.escape_html(this.site_settings_categories[t][1])+"</span></label>";e+=" </div>",$(".ms-browser-filters",this.$top_menu).append(e),$("#open_hidden_categories",this.$top_menu).click(function(){$("#hidden_categories").hasClass("hidden-visibility")?($(".fa",this).removeClass("fa-angle-down").addClass("fa-angle-up"),$("#hidden_categories").removeClass("hidden-visibility")):($("#hidden_categories").addClass("hidden-visibility"),$(".fa",this).removeClass("fa-angle-up").addClass("fa-angle-down"))}),$("#hidden_categories .checkbox",this.$top_menu).click(function(){var e=this.checked;i.filter_no_categories=!1,$("#filter_no_categories",i.$top_menu).prop("checked",!1),e?i.filter_categories.push(this.value):i.filter_categories.splice(i.filter_categories.indexOf(this.value),1),i.channels.refresh_display(!0),i.latest.refresh_display(!0),i.search.refresh_display(!0)}),$("#filter_no_categories",this.$top_menu).click(function(){this.checked?(i.filter_categories=[],$("#hidden_categories .checkbox",i.$top_menu).prop("checked",!1),i.filter_no_categories=!0,i.channels.refresh_display(!0),i.latest.refresh_display(!0),i.search.refresh_display(!0)):(i.filter_no_categories=!1,i.channels.refresh_display(!0),i.latest.refresh_display(!0),i.search.refresh_display(!0))})}},MSBrowser.prototype.remove_oid_from_tab=function(e,t){var s,i,a,n;if($(".item-entry-"+t,e.$content).remove(),e.last_response)for(s=["items","channels","live_streams","videos","photos_groups"],i=0;i<s.length;i++){if(a=-1,e.last_response[s[i]])for(n=0;n<e.last_response[s[i]].length;n++)if(e.last_response[s[i]][n].oid==t){a=n;break}if(-1!=a){e.last_response[s[i]].splice(a,1);break}}},MSBrowserLatest.prototype.get_displayable_content=function(){var e=this.browser.displayable_content;return e.length>1&&this.browser.lti_mode&&-1!=e.indexOf("c")&&(e=e.replace(/c/g,"")),e},MSBrowserLatest.prototype.get_menu_jq=function(){var e=this.get_displayable_content(),t="";return t+='<div id="ms_browser_latest_menu" style="display: none;">',e.length>1&&(t+='<div class="ms-browser-dropdown" id="ms_browser_latest_types_dropdown">',t+='<button type="button" aria-controls="ms_browser_latest_types_dropdown_menu" aria-expanded="false" class="button ms-browser-dropdown-button '+this.browser.btn_class+'">'+utils.translate("Content types")+' <i class="fa fa-angle-down" aria-hidden="true"></i></button>',t+='<div class="ms-browser-dropdown-menu ms-browser-latest-types" id="ms_browser_latest_types_dropdown_menu">',t+="<h4>"+utils.translate("Content types to display:")+"</h4>",-1!=e.indexOf("c")&&(t+='<p><input id="latest_display_channel" type="checkbox">',t+=' <label for="latest_display_channel">'+utils.translate("channels")+"</label></p>"),-1!=e.indexOf("v")&&(t+='<p><input id="latest_display_video" type="checkbox">',t+=' <label for="latest_display_video">'+utils.translate("videos")+"</label></p>"),-1!=e.indexOf("l")&&(t+='<p><input id="latest_display_live" type="checkbox">',t+=' <label for="latest_display_live">'+utils.translate("live streams")+"</label></p>"),-1!=e.indexOf("p")&&(t+='<p><input id="latest_display_photos" type="checkbox">',t+=' <label for="latest_display_photos">'+utils.translate("photos")+"</label></p>"),t+="</div>",t+="</div>"),t+="</div>",this.$menu=$(t),e.length>1&&(this.browser.setup_dropdown($("#ms_browser_latest_types_dropdown",this.$menu)),$(".ms-browser-latest-types input",this.$menu).change({obj:this},function(e){var t,s;e.data.obj.refresh_display(!0),t=this.id.split("_")[2][0],(s=utils.get_cookie("catalog-lastest_types"))||(s="vlp"),this.checked?-1==s.indexOf(t)&&(s+=t):s=s.replace(new RegExp(t),""),utils.set_cookie("catalog-lastest_types",s)})),this.$menu},MSBrowserLatest.prototype.get_content_jq=function(){var e=utils.translate("Display {count} more items"),t="";return t+='<div id="ms_browser_latest" class="ms-browser-content" style="display: none;">',t+='<div class="messages">',t+='<div class="message info">'+utils.translate("This list presents all media and channels ordered by add date.")+"</div>",t+="</div>",t+='<div class="ms-browser-latest-place"></div>',t+='<div class="ms-browser-latest-btns">',t+='<button type="button" class="button ms-browser-latest-more-10">'+e.replace(/\{count\}/,"10")+"</button>",t+='<button type="button" class="button ms-browser-latest-more-30">'+e.replace(/\{count\}/,"30")+"</button>",t+="</div>",t+="</div>",this.$content=$(t),this.$place=$(".ms-browser-latest-place",this.$content),$(".ms-browser-latest-more-10",this.$content).click({obj:this},function(e){e.data.obj.display_more(10)}),$(".ms-browser-latest-more-30",this.$content).click({obj:this},function(e){e.data.obj.display_more(30)}),this.$content},MSBrowserLatest.prototype.on_show=function(){var e;this.browser.set_title("latest",utils.translate("Latest content added")),this.initialized||(this.initialized=!0,this.get_displayable_content().length>1&&((e=utils.get_cookie("catalog-lastest_types"))||(e="vlp"),$(".ms-browser-latest-types #latest_display_channel",this.$menu).prop("checked",-1!=e.indexOf("c")),$(".ms-browser-latest-types #latest_display_video",this.$menu).prop("checked",-1!=e.indexOf("v")),$(".ms-browser-latest-types #latest_display_live",this.$menu).prop("checked",-1!=e.indexOf("l")),$(".ms-browser-latest-types #latest_display_photos",this.$menu).prop("checked",-1!=e.indexOf("p"))),this.load_latest())},MSBrowserLatest.prototype.load_latest=function(e,t){var s,i,a,n,o;if(!this.latest_loading){if(this.latest_loading=!0,i={},(s=this.get_displayable_content()).length>1?(i.content="",-1!=s.indexOf("c")&&$("#latest_display_channel",this.$menu).is(":checked")&&(i.content+="c"),-1!=s.indexOf("v")&&$("#latest_display_video",this.$menu).is(":checked")&&(i.content+="v"),-1!=s.indexOf("l")&&$("#latest_display_live",this.$menu).is(":checked")&&(i.content+="l"),-1!=s.indexOf("p")&&$("#latest_display_photos",this.$menu).is(":checked")&&(i.content+="p")):s&&(i.content=s),null!==this.browser.filter_editable&&(i.editable=this.browser.filter_editable?"yes":"no"),null!==this.browser.filter_validated&&(i.validated=this.browser.filter_validated?"yes":"no"),null!==this.browser.filter_speaker&&(i.speaker=this.browser.filter_speaker),this.browser.filter_no_categories?i.no_categories=!0:this.browser.filter_categories.length>0&&(i.categories=this.browser.filter_categories.join("\n")),a=0,this.start_date&&(i.start=this.start_date,a=parseInt(this.start_date.replace(new RegExp("[-_]","g"),""),10),isNaN(a)&&(a=0)),t){if(n=parseInt(t.replace(new RegExp("[-_]","g"),""),10),a>0&&!isNaN(n)&&n>=a)return this.latest_loading=!1,void console.log("cancelled");i.end=t}e&&(i.count=e),o=this,this.browser.display_loading(),this.browser.msapi.ajax_call("get_latest_content",i,function(e){e.items&&e.items.length>0&&(o.last_response?o.last_response.items=o.last_response.items.concat(e.items):o.last_response=e),o._on_ajax_response(e),o.latest_loading=!1})}},MSBrowserLatest.prototype._on_ajax_error=function(e){var t,s='<div class="messages">';this.browser.use_overlay||"403"!=e.error_code&&"401"!=e.error_code?s+='<div class="message error">'+e.error+"</div>":(t=this.browser.url_login+"?next="+window.location.pathname+(window.location.hash?window.location.hash.substring(1):""),s+='<div class="item-description">',s+='<div class="message error">'+e.error+"</div>",s+="<p>"+utils.translate("Please login to access this page")+'<br /> <a href="'+t+'">'+utils.translate("Sign in")+"</a></p>",s+="</div>"),s+="</div>",this.$place.html(s)},MSBrowserLatest.prototype._on_ajax_response=function(e){var t,s,i,a,n,o;if(this.browser.hide_loading(),!e.success)return this._on_ajax_error(e);for(e.can_add_channel&&(this.can_add_channel=!0),e.can_add_video&&(this.can_add_video=!0),this.start_date=e.max_date,this.more=!0===e.more,t=0;t<e.items.length;t++)(s=e.items[t]).date_label&&s.date_label!=this.date_label?(this.date_label=s.date_label,i=this.browser.pick_mode?"h3":"h2",this.$place.append("<"+i+">"+s.date_label+"</"+i+">"),this.$section=$('<ul class="ms-browser-section"></ul>'),this.$place.append(this.$section)):this.$section||(this.$section=$('<ul class="ms-browser-section"></ul>'),this.$place.append(this.$section),console.log("A browser section is missing in latest tab. This should not happen.",s.date_label,this.date_label)),a="channel","v"==s.type&&(a="video"),"l"==s.type&&(a="live"),"p"==s.type&&(a="photos"),n=-1!=this.browser.selectable_content.indexOf(s.type),this.$section.append(this.browser.get_content_entry(a,s,n,"latest"));null===this.$section&&(o=$('<div class="messages"><div class="message info">'+utils.translate("No contents.")+"</div></div>"),this.$place.append(o)),this.more?$(".ms-browser-latest-btns",this.$content).css("display","block"):$(".ms-browser-latest-btns",this.$content).css("display","none")},MSBrowserLatest.prototype.display_more=function(e){this.more&&this.load_latest(e)},MSBrowserLatest.prototype.refresh_display=function(e){e&&(this.last_response=null),this.last_response?(this.date_label="",this.$section=null,this.$place.html(""),this._on_ajax_response(this.last_response)):(this.more=!1,this.start_date="",this.date_label="",this.$section=null,this.$place.html(""),this.load_latest())},MSBrowserLatest.prototype.remove=function(e){this.browser.remove_oid_from_tab(this,e)},MSBrowserSearch.prototype.get_displayable_content=function(){var e=this.browser.displayable_content;return e.length>1&&this.browser.lti_mode&&-1!=e.indexOf("c")&&(e=e.replace(/c/g,"")),e},MSBrowserSearch.prototype.should_be_displayed=function(e,t){if(!t)return!0;for(var s=0;s<e.length;s++)if(-1!=t.indexOf(e[s]))return!0;return!1},MSBrowserSearch.prototype.get_menu_jq=function(){var e,t,s=this.get_displayable_content(),i="";for(i+='<div id="ms_browser_search_menu" style="display: none;">',i+='<form class="ms-browser-search-form" method="get" action="." onsubmit="javascript: return false;">',i+='<label for="ms_browser_search_text"><span class="hidden-below-800">'+utils.translate("Search:")+"</span></label>",i+=' <input id="ms_browser_search_text" type="text" value="">',i+=' <button type="submit" class="button" id="ms_browser_search_start">'+utils.translate("Go")+"</button>",i+="</form>",i+='<div class="ms-browser-dropdown" id="ms_browser_search_in_dropdown">',i+='<button type="button" aria-controls="ms_browser_search_in_dropdown_menu" aria-expanded="false" class="button ms-browser-dropdown-button '+this.browser.btn_class+'">'+utils.translate("Search in")+' <i class="fa fa-angle-down" aria-hidden="true"></i></button>',i+='<div class="ms-browser-dropdown-menu ms-browser-search-in" id="ms_browser_search_in_dropdown_menu">',i+=' <div><button type="button" class="button" id="ms_browser_search_in_all">'+utils.translate("all")+"</button>",i+=' <button type="button" class="button" id="ms_browser_search_in_none">'+utils.translate("none")+"</button></div>",e=0;e<this.search_in_fields.length;e++)t=this.search_in_fields[e],this.should_be_displayed(s,t.items)&&(i+=' <div><input id="ms_browser_search_'+t.name+'" type="checkbox" '+(t.initial?'checked="checked"':"")+">",i+=' <label for="ms_browser_search_'+t.name+'">'+utils.escape_html(utils.translate(t.label))+"</label></div>");if(i+="</div>",i+="</div>",s.length>1){for(i+='<div class="ms-browser-dropdown" id="ms_browser_search_for_dropdown">',i+='<button type="button" aria-controls="ms_browser_search_for_dropdown_menu" aria-expanded="false" class="button ms-browser-dropdown-button '+this.browser.btn_class+'">'+utils.translate("Search for")+' <i class="fa fa-angle-down" aria-hidden="true"></i></button>',i+='<div class="ms-browser-dropdown-menu ms-browser-search-for" id="ms_browser_search_for_dropdown_menu">',i+=' <div><button type="button" class="button" id="ms_browser_search_for_all">'+utils.translate("all")+"</button>",i+=' <button type="button" class="button" id="ms_browser_search_for_none">'+utils.translate("none")+"</button></div>",e=0;e<this.search_for_fields.length;e++)t=this.search_for_fields[e],this.should_be_displayed(s,t.items)&&(i+=' <div><input id="ms_browser_search_'+t.name+'" type="checkbox" '+(t.initial?'checked="checked"':"")+">",i+=' <label for="ms_browser_search_'+t.name+'">'+utils.escape_html(utils.translate(t.label))+"</label></div>");i+="</div>",i+="</div>"}return i+="</div>",this.$menu=$(i),this.browser.setup_dropdown($("#ms_browser_search_in_dropdown",this.$menu)),this.browser.setup_dropdown($("#ms_browser_search_for_dropdown",this.$menu)),$("form",this.$menu).submit({obj:this},function(e){e.data.obj.on_search_submit()}),$("#ms_browser_search_in_all",this.$menu).click({obj:this},function(e){$(".ms-browser-search-in input[type=checkbox]",e.data.obj.$main).prop("checked",!0),e.data.obj.on_search_submit()}),$("#ms_browser_search_in_none",this.$menu).click({obj:this},function(e){$(".ms-browser-search-in input[type=checkbox]",e.data.obj.$main).prop("checked",!1),e.data.obj.on_search_submit()}),$("#ms_browser_search_for_all",this.$menu).click({obj:this},function(e){$(".ms-browser-search-for input[type=checkbox]",e.data.obj.$main).prop("checked",!0),e.data.obj.on_search_submit()}),$("#ms_browser_search_for_none",this.$menu).click({obj:this},function(e){$(".ms-browser-search-for input[type=checkbox]",e.data.obj.$main).prop("checked",!1),e.data.obj.on_search_submit()}),$("input[type=checkbox]",this.$menu).change({obj:this},function(e){e.data.obj.on_search_submit()}),this.$menu},MSBrowserSearch.prototype.get_content_jq=function(){var e="";return e+='<div id="ms_browser_search" class="ms-browser-content" style="display: none;">',e+='<div class="messages"><div class="message info">'+utils.translate("Use the input above to search for something.")+"</div></div>",e+="</div>",this.$content=$(e),this.$content},MSBrowserSearch.prototype.on_show=function(){this.browser.set_title(this.current_title?this.current_title:utils.translate("Search")),this.initialized||(this.initialized=!0,this.on_url_change(),this.browser.use_overlay||"search"!=this.browser.get_active_tab()||$("#top_search_form form").submit({obj:this},function(e){return $("#ms_browser_search_text").val($("#top_search_input").val()),e.data.obj.on_search_submit(),!1}))},MSBrowserSearch.prototype.on_url_change=function(){var e,t,s,i,a;if(this.initialized){for(e=this.browser.parse_url(),t=this.get_displayable_content(),s=0;s<this.search_in_fields.length;s++)i=this.search_in_fields[s],this.should_be_displayed(t,i.items)&&(a=e.has_in_vals?!!e[i.name]:i.initial,$("#ms_browser_search_"+i.name,this.$menu).prop("checked",a));for(s=0;s<this.search_for_fields.length;s++)i=this.search_for_fields[s],this.should_be_displayed(t,i.items)&&(a=e.has_for_vals?!!e[i.name]:i.initial,$("#ms_browser_search_"+i.name,this.$menu).prop("checked",a));e.text&&($("#ms_browser_search_text",this.$menu).val(e.text),this.on_search_submit(!0))}},MSBrowserSearch.prototype.on_search_submit=function(e){var t,s,i,a,n,o,l,r,c,d,h=$("#ms_browser_search_text",this.$menu).val();if(h){for(this.browser.display_loading(),t=this.get_displayable_content(),s="text="+h,i="",a=0;a<this.search_in_fields.length;a++)n=this.search_in_fields[a],this.should_be_displayed(t,n.items)&&$("#ms_browser_search_"+n.name,this.$menu).is(":checked")&&(i+=n.name.substring(2),s+="&"+n.name);for(i=i?i.substring(1):"metadata",o="",a=0;a<this.search_for_fields.length;a++)n=this.search_for_fields[a],this.should_be_displayed(t,n.items)&&$("#ms_browser_search_"+n.name,this.$menu).is(":checked")&&(o+=n.name.substring(4,5),s+="&"+n.name);o||(o=t),l={search:h,content:o,fields:i},null!==this.browser.filter_editable&&(l.editable=this.browser.filter_editable?"yes":"no"),null!==this.browser.filter_validated&&(l.validated=this.browser.filter_validated?"yes":"no"),null!==this.browser.filter_speaker&&(l.speaker=this.browser.filter_speaker),this.browser.filter_no_categories?l.no_categories=!0:this.browser.filter_categories.length>0&&(l.categories=this.browser.filter_categories.join("\n")),r=utils.escape_html(utils.translate("Search results for:")+" "+h),this.current_title=r,this.browser.set_title(r),this.browser.pick_mode||e||((c=this.browser.url_search).indexOf("?")<0?c+="?"+s:c+="&"+s,this.last_url&&this.last_url==c||(this.last_url=c,window.history.pushState({ms_tab:"search",search:h},r,c))),d=this,this.browser.msapi.ajax_call("search",l,function(e){d._on_ajax_response(e),window.ga_pageview&&window.ga_pageview("ajax search","/ajax_search?search="+l.search+"&fields="+l.fields)})}},MSBrowserSearch.prototype._on_ajax_error=function(e){var t,s;this.last_response=null,t='<div class="messages">',this.browser.use_overlay||"403"!=e.error_code&&"401"!=e.error_code?t+='<div class="message error">'+utils.escape_html(e.error)+"</div>":(s=this.browser.url_login+"?next="+window.location.pathname+(window.location.hash?window.location.hash.substring(1):""),t+='<div class="item-description">',t+='<div class="message error">'+utils.escape_html(e.error)+"</div>",t+="<p>"+utils.translate("Please login to access this page")+'<br /> <a href="'+s+'">'+utils.translate("Sign in")+"</a></p>",t+="</div>"),t+="</div>",this.$content.html(t)},MSBrowserSearch.prototype._on_ajax_response=function(e){var t,s,i,a,n,o,l;if(this.browser.hide_loading(),!e.success)return this._on_ajax_error(e);this.last_response=e,t=e.channels?e.channels.length:0,s=e.videos?e.videos.length:0,i=e.live_streams?e.live_streams.length:0,a=e.photos_groups?e.photos_groups.length:0,n=t>0||s>0||i>0||a>0,this.$content.html(""),n?(o=[],t>0&&o.push(t+" "+utils.translate("channel(s)")),s>0&&o.push(s+" "+utils.translate("video(s)")),i>0&&o.push(i+" "+utils.translate("live stream(s)")),a>0&&o.push(a+" "+utils.translate("photos group(s)")),l='<div class="ms-browser-search-matching"><b>'+utils.translate("Matching items:")+"</b> "+utils.escape_html(o.join(", "))+"</div>",this.$content.append(l),this.browser.display_content(this.$content,e,null,"search")):this.$content.html('<div class="messages"><div class="message info">'+utils.translate("No results.")+"</div></div>")},MSBrowserSearch.prototype.refresh_display=function(e){e&&this.last_response&&(this.last_response=null),this.last_response?this._on_ajax_response(this.last_response):this.on_search_submit(!0)},MSBrowserSearch.prototype.remove=function(e){this.browser.remove_oid_from_tab(this,e)},MSBrowser.prototype.init=function(){var e,t,s,i;this.initialized||(this.initialized=!0,"thumbnail"==utils.get_cookie("catalog-display_mode")&&(this.display_as_thumbnails=!0,this.use_overlay||$("#container").removeClass("max-width-1200")),"yes"==utils.get_cookie("catalog-display_types_icons")&&(this.display_types_icons=!0),e=this.parse_url(),this.use_overlay||(this.pick_mode=!1,t=[],e.iframe&&(this.iframe_mode=!0,this.url_login="/login/iframe/",t.push("iframe")),e.speaker&&(this.filter_speaker=e.speaker,t.push("speaker="+window.encodeURIComponent(this.filter_speaker))),e.mine&&(this.filter_speaker="self",t.push("mine"),this.tree_manager=!1),e.lti&&(this.lti_mode=!0,this.filter_speaker="self",t.push("lti")),e.newtab&&(this.links_target=' target="_blank"',t.push("newtab")),e.pick&&(this.pick_mode=!0,e.pick.toString().match(/^[cvlp]+$/)?(this.selectable_content=e.pick,this.displayable_content=e.pick,this.displayable_content.indexOf("c")<0&&(this.displayable_content="c"+this.displayable_content)):(this.selectable_content="vlp",this.displayable_content="cvlp"),t.push("pick="+this.selectable_content),!this.initial_oid&&e.initial&&(this.initial_oid=e.initial.toString(),t.push("initial="+window.encodeURIComponent(this.initial_oid)))),e.return&&(window.parent&&0===e.return.toString().indexOf("postMessageAPI")||0===e.return.toString().indexOf("https://")&&e.return.toString().length>8)&&(this.pick_mode||(this.pick_mode=!0,this.selectable_content="vlp",this.displayable_content="cvlp",t.push("pick="+this.selectable_content)),t.push("return="+e.return),s=window.parent&&0===e.return.toString().indexOf("postMessageAPI")?e.return:this.url_post_link+"?return="+e.return,this.on_pick=function(e,t){var i,a;t||(0===s.indexOf("postMessageAPI")?(i=window.opener?window.opener.parent:window.parent,a=s.substring("postMessageAPI".length).replace(/^:+|:+$/g,""),i.postMessage({item:e,initial_pick:!!t,target:a},"*"),window.opener&&window.close()):window.location=s+"&oid="+e.oid)}),t.length>0&&(this.links_url_params=t.join("&"),this.url_login+="?"+this.links_url_params,this.url_channels+="?"+this.links_url_params,this.url_latest+="?"+this.links_url_params,this.url_search+="?"+this.links_url_params)),this.init_options.browser=this,this.current_selection&&this.current_selection.oid&&(0!==this.current_selection.oid.indexOf("c")&&isNaN(parseInt(this.current_selection.oid,10))?this.init_options.current_channel_oid=this.current_selection.parent_oid:this.init_options.current_channel_oid=this.current_selection.oid),this.channels=new MSBrowserChannels(this.init_options),this.latest=new MSBrowserLatest(this.init_options),this.search=new MSBrowserSearch(this.init_options),this.build_widget(),this.initial_state&&this.initial_state.tab?this.change_tab(this.initial_state.tab,!0):this.change_tab("channels",!0),this.initial_oid&&this.pick(this.initial_oid,null,!0),i=this,this.use_overlay?this.overlay=new OverlayDisplayManager:(window.onpopstate=function(e){i.on_url_change(e.target.location)},$(window).bind("hashchange",function(){i.on_url_change()})),this.load_categories(),$(window).resize(function(){i.on_resize()}),this.on_resize())},MSBrowser.prototype.open=function(){if(this.use_overlay){this.init();var e=this;this.overlay.show({mode:"html",title:this.title,html:this.$widget,on_hide:function(){e.$widget.detach()}})}},MSBrowser.prototype.update_catalog=function(e,t){if(e&&e.oid)if(this.catalog[e.oid]){for(var s in e)this.catalog[e.oid][s]=e[s];t&&(this.catalog[e.oid].is_full=!0)}else t&&(e.is_full=!0),this.catalog[e.oid]=e},MSBrowser.prototype.get_info_for_oid=function(e,t,s){var i=e&&("v"==e[0]||"l"==e[0]||"p"==e[0]);return this.get_info({oid:e},i,t,s)},MSBrowser.prototype.get_info_for_slug=function(e,t,s,i){return this.get_info({slug:e},t,s,i)},MSBrowser.prototype.get_info=function(e,t,s,i){var a,n,o,l,r;if((e.oid||e.slug)&&i){for(o in a=e.oid?"oid":"slug",n=null,this.catalog)if((!t&&"c"==o[0]||t&&"c"!=o[0])&&this.catalog[o][a]==e[a]){s?this.catalog[o].is_full&&(n=this.catalog[o]):n=this.catalog[o];break}if(n)return i({success:!0,info:n});this.display_loading(),s&&(e.full="yes"),l=t?"get_medias":"get_channels",r=this,this.msapi.ajax_call(l,e,function(e){e.success&&r.update_catalog(e.info,s),r.hide_loading(),i(e)})}},MSBrowser.prototype.pick=function(e,t,s){if(null!=e)if(this.catalog[e]&&this.catalog[e].is_full)this._pick(e,{success:!0,info:this.catalog[e]},t,s);else{var i=this;this.get_info_for_oid(e,!0,function(a){i._pick(e,a,t,s)})}else this.current_selection&&this.current_selection.oid&&$(".item-entry-"+this.current_selection.oid,this.$main).removeClass("selected")},MSBrowser.prototype._pick=function(e,t,s,i){t.success?this.pick_mode?(this.current_selection&&this.current_selection.oid&&$(".item-entry-"+this.current_selection.oid,this.$main).removeClass("selected"),this.current_selection=this.catalog[e],$(".item-entry-"+this.current_selection.oid,this.$main).addClass("selected"),this.overlay&&!i&&this.overlay.hide(),this.on_pick&&this.on_pick(this.catalog[e],i),!this.use_overlay&&t.info.parent_slug&&(window.location.hash="#"+t.info.parent_slug),!this.channels||i&&this.initial_state&&this.initial_state.channel_slug||(0!==e.indexOf("c")&&isNaN(parseInt(e,10))?this.channels.display_channel(t.info.parent_oid):this.channels.display_channel(e))):"delete"==s&&window.delete_form_manager&&window.delete_form_manager.show(e,this.catalog[e].title):console.log("Unable to get info about initial selection:"+t.error)},MSBrowser.prototype.remove=function(e){e&&this.catalog[e]&&(this.channels.remove(e),this.latest.remove(e),this.search.remove(e))},MSBrowser.prototype.get_last_pick=function(){return this.current_selection},MSBrowser.prototype.get_selected_oid=function(){return this.initialized?this.current_selection?this.current_selection.oid:null:this.initial_oid},MSBrowser.prototype.parse_url=function(){var e,t,s,i,a={},n=window.location.search?window.location.search.substring(1):null;if(n)for(e=n.split("&"),t=0;t<e.length;t++)-1!=e[t].indexOf("=")?(s=e[t].substring(0,e[t].indexOf("=")),i="on"==(i=e[t].substring(s.length+1))||"off"!=i&&window.decodeURIComponent(i.replace(/\+/g,"%20"))):(s=e[t],i=!0),"in_"==s.substring(0,3)?a.has_in_vals=!0:"for_"==s.substring(0,4)&&(a.has_for_vals=!0),a[s]=i;return a},MSBrowser.prototype.on_url_change=function(){var e,t=window.location.pathname+window.location.search;0===t.indexOf("/channels/")?((e=window.location.hash)&&"#"==e[0]&&(e=e.substring(1)),e?this.channels.display_channel_by_slug(e):"self"==this.filter_speaker?this.channels.display_personal_channel():this.channels.display_channel("0"),this.change_tab("channels",!0)):0===t.indexOf("/latest/")?this.change_tab("latest",!0):0===t.indexOf("/search/")&&(this.search.on_url_change(),this.change_tab("search",!0))},MSBrowser.prototype.on_resize=function(){var e,t;this.use_overlay&&(e=$(window).width()-70,this.$widget.width(e),t=$(window).height()-100,this.$widget.height(t))},MSBrowser.prototype.load_categories=function(){var e=this;this.msapi.ajax_call("list_categories",{},function(t){t.data&&(e.site_settings_categories=t.data,e.display_categories())})},utils.add_translations({"Access denied.":"Accès refusé.","Add a channel":"Ajouter une chaîne","Add a sub channel":"Ajouter une sous chaîne","Add a video":"Ajouter une vidéo","Add date, ascending":"Date d'ajout, croissante","Add date, descending":"Date d'ajout, décroissante","Added on":"Ajouté le",all:"tout","An error occurred during request:":"Une erreur est survenue pendant la requête :","An error occurred in the server. Please try again later.":"La requête a échoué. Veuillez réessayer plus tard.","An internal server error occurred. An email has been sent to the support team.":"Une erreur interne au serveur est survenue. Un email a été envoyé à l'équipe de support afin de résoudre le problème.","Annotations last month":"Annotations ce mois",Annotations:"Annotations",annotations:"annotations",Apply:"Appliquer",April:"avril",at:"à",August:"ao&ucirc;t","Available space:":"Espace disponible :",B:"o","cannot copy":"impossible de copier",Categories:"Catégories",categories:"catégories","Channel content:":"Contenu de la chaîne :",channel:"chaîne","channel(s)":"chaîne(s)","Channel:":"Chaîne :","Channels list":"Liste des chaînes",channels:"chaînes",Channels:"Chaînes",chapters:"chapitres","classic RichMedia":"RichMedia classique","Click to display the content of this channel":"Cliquez pour afficher cette chaîne","Click to select this media":"Cliquez pour sélectionner ce média","comments, slides, ...":"commentaires, diapositives, ...",companies:"sociétés","Content types to display:":"Types de contenu à afficher :","Content types":"Types de contenu",copied:"copié","Copy LTI link":"Copier le lien LTI","Created on":"Créé le","Creation date, ascending":"Date de création, croissante","Creation date, descending":"Date de création, décroissante","Current channel":"Chaîne courante",December:"d&eacute;cembre",descriptions:"descriptions","Display channel":"Afficher la chaîne","Display channels":"Afficher les chaînes","display items type icons":"afficher les icônes de type des éléments","Display mode:":"Mode d'affichage :","Display parent channel":"Afficher la chaîne parente","Display {count} more items":"Afficher {count} vidéos de plus",Display:"Affichage",Duration:"Durée","dynamic RichMedia":"RichMedia dynamique","Edit it":"Éditer","Edit this channel":"Éditer cette chaîne",Edit:"Éditer","Editable:":"Éditable:","failed to copy":"échec de la copie",February:"f&eacute;vrier","Filters:":"Filtres :",Go:"Envoyer",help:"aide","Hide this window":"Fermer cette fenêtre","Information about media":"Informations sur le média","Item not found.":"Élément introuvable.","iTunes (audio only)":"iTunes (audio uniquement)",January:"janvier",July:"juillet",June:"juin",keywords:"mots clés","Latest content added":"Contenu récemment ajouté","Latest content":"Contenu récent",licenses:"licences",list:" liste","live stream(s)":"diffusion(s) en direct","live streams":"diffusions en direct","Live streams":"Diffusions en direct",Loading:"Chargement","Loading...":"Chargement ...",locations:"emplacements","Main channels":"Chaînes principales",March:"mars","Matching annotations:":"Annotations correspondantes :","Matching items:":"Éléments correspondants :","Matching photos:":"Photos correspondantes :",May:"mai","Media does not exist.":"Le média n'existe pas.","My channel":"Ma chaîne","My media":"Mes médias","No available space":"Pas d'espace disponible","No contents.":"Pas de contenu.","No information about error.":"Informations sur le média","No information about media.":"Pas d'informations sur le média","No results.":"Pas de résultats.",no:"non",none:"aucun",November:"novembre","Number of annotations, ascending":"Nombre de annotations, croissant","Number of annotations, descending":"Nombre de annotations, décroissant","Number of views, ascending":"Nombre de vues, croissant","Number of views, descending":"Nombre de vues, décroissant",October:"octobre","Open information panel":"Ouvrir le panneau d'information","Parent channel":"Chaîne parente","Parent channel:":"Chaîne parente :","photos group(s)":"groupe(s) de photos","photos groups":"groupes de photos","Photos groups":"Groupes de photos",photos:"photos","Please login to access this channel":"Veuillez vous connecter pour accéder à cette chaîne","Published:":"Publié:","Publishing date":"Date de publication","Recording date":"Date d'enregistrement","Requested channel does not exist.":"La chaîne demandée n'existe pas.",Root:"Racine","Search for":"Contenu à rechercher","Search in my media":"Rechercher dans mes médias","Search in progress":"Recherche en cours","Search in":"Rechercher dans","Search results for:":"Résultats de recherche pour:",Search:"Rechercher","Search:":"Rechercher :",See:"Voir","Select a channel to display its content.":"Sélectionnez une chaîne pour afficher son contenu.","Select a channel":"Sélectionner une chaîne","Select a media":"Sélectionner un média","Select this channel":"Sélectionner cette chaîne","Select this media":"Sélectionner ce média","selected setting":"option sélectionnée","selected tab":"onglet sélectionné",September:"septembre","Sign in":"Connection","Some contents may still exist in this channel but if it is the case your account is not allowed to see them.":"Du contenu peut tout de même être présent dans cette chaîne mais si c'est le cas, votre compte utilisateur ne possède pas la permission de le voir.","Sort by:":"Trier par :",Speaker:"Intervenant","Speaker:":"Intervenant :",speakers:"intervenants",standard:"standard","Storage usage":"Stockage utilisé","Storage usage:":"Stockage utilisé :","Sub channels items are included in counts.":"Les éléments contenus dans les sous chaînes sont inclus dans les comptes.","Sub channels":"Sous chaînes","Subscribe to channel videos RSS":"S'abonner au flux RSS des vidéos de la chaîne","Subscribe to channel videos RSS:":"S'abonner au flux RSS des vidéos de la chaîne :","The connection timed out. Please retry later.":"Le délai d'attente de réponse a été dépassé. Veuillez réessayez plus tard.","The query has been found in audio:":"Le mot recherché a été trouvé dans la bande audio de cette vidéo :","The query has been found in following photos:":"Le mot recherché a été trouvé dans les photos suivantes :","The query has been found in following slides:":"Le mot recherché a été trouvé dans les diapositives suivantes :","The server cannot be reached.":"Le serveur est injoignable.","The storage quota of the parent channels can have an impact on the available space of this channel.":"Le quota de stockage des chaînes en amont peut avoir un impact sur l'espace disponible dans cette chaîne.","This channel contains no media.":"Cette chaîne ne contient pas de médias","This channel contains no sub channels and no media.":"Cette chaîne ne contient pas de sous chaînes ni de médias","This channel contains no sub channels.":"Cette chaîne ne contient pas de sous chaînes","This channel is selected":"Cette chaîne est sélectionnée","This channel is unlisted":"Cette chaîne est non listée","This item is a channel":"Cet élément est une chaîne","This item is a live stream":"Cet élément est une diffusion en direct","This item is a photos group":"Cet élément est un groupe de photos","This item is a video":"Cet élément est une vidéo","This list presents all media and channels ordered by add date.":"Cette liste présente les derniers éléments ajoutés triés par date d'ajout.","This media is not published":"Ce média n'est pas publié","This media is published and unlisted":"Ce média est publié et non listé","This media is published":"Ce média est publié","This media is selected":"Ce média est sélectionné","this month":"ce mois","This video is not ready":"Cette vidéo n'est pas prête",thumbnails:"vignettes","Title, ascending":"Titre, croissant","Title, descending":"Titre, décroissant",titles:"titres","Type:":"Type :","Unable to get channel content because you cannot access to this channel.":"Impossible d'obtenir la liste du contenu de la chaîne car vous ne disposez pas du droit d'accès à cette chaîne.","Unable to get channel content. Request timed out.":"Impossible d'obtenir le contenu de la chaîne. Délai d'attente pour la requête expiré.","Unable to get channel information because you cannot access to this channel.":"Impossible d'obtenir les informations sur la chaîne car vous ne pouvez pas accéder à cette chaîne.","Unable to get channels tree because you are not logged in.":"Impossible d'obtenir la liste des chaînes, vous n'êtes pas authentifié","Unable to get channels tree because you cannot access to this channel.":"Impossible d'obtenir la liste du contenu de la chaîne car vous ne disposez pas du droit d'accès à cette chaîne.","Unable to get channels tree. Request timed out.":"Impossible d'obtenir la liste des chaînes. Délai d'attente de la requête écoulé.","Unable to get media information because you cannot access to this media.":"Impossible d'obtenir les informations sur le média car vous ne pouvez pas accéder à ce média.","Unable to get media information. Request timed out.":"Impossible d'obtenir les informations sur le média. Délai d'attente de la requête écoulé.","Unable to get search's results content because you cannot access to this channel.":"Impossible d'obtenir les résultats de la recherche car vous ne disposez pas du droit d'accès à cette chaîne.",unspecified:"non spécifié",Unspecified:"Non spécifié","Use channel default sorting":"Utiliser le tri par défaut des chaînes","Use the input above to search for something.":"Utilisez le champ de texte ci dessus pour rechercher du contenu.",video:"vidéo","video(s)":"vidéo(s)",videos:"vidéos",Videos:"Vidéos","Views last month":"Vues ce mois",Views:"Vues",views:"vues",yes:"oui",selected:"sélectionné","You are not allowed to have a personnal channel.":"Vous n'avez pas la permission de disposer d'une chaîne personnelle.","You are not logged in or your session has expired. Please login and retry.":"Vous n'êtes pas connecté ou votre session a expiré. Veuillez vous reconnecter puis réessayez."},"fr"),MSTreeManager.prototype.init=function(){var e,t;if(!this.loaded&&!this.loading){if(!this.$place)return console.log("No place defined for tree.");if(!this.$place.length)return console.log("Place for tree doesn't exist. Requested place:",this.$place);for(this.loading=!0,window.location.search&&(this.channels_base_url=this.channels_base_url.substring(0,this.channels_base_url.length-1)+window.location.search+"#"),this.id_prefix="";$("#"+this.id_prefix+"tree_channel_0").length>0;)this.id_prefix+="_";e="<div>",this.display_root&&(e+='<div id="'+this.id_prefix+'tree_channel_0_link" '+("0"==this.current_channel_oid?'class="channel-active"':"")+">",this.on_change?e+='<button type="button" data-ref="0" class="channel-btn"'+("0"==this.current_channel_oid?'title="'+utils.translate("Root")+" "+utils.translate("selected")+'"':"")+">"+utils.translate("Root")+"</button>":e+='<a href="'+this.channels_base_url+'" class="channel-btn"'+("0"==this.current_channel_oid?'title="'+utils.translate("Root")+" "+utils.translate("selected")+'"':"")+">"+utils.translate("Root")+"</a>",e+="</div>"),e+='<ul class="list js-active-item border-color-blue active" id="'+this.id_prefix+'tree_channel_0"></ul></div>',this.$widget=$(e),this.display_root&&this.on_change&&$(".channel-btn",this.$widget).click({obj:this},function(e){e.data.obj.on_change($(this).attr("data-ref"))}),t=this,this.loading=!1,this.load_tree("0",function(e){if(t.loaded=!0,e.success&&t.initial_oid&&t.current_channel_oid==t.initial_oid&&t.open_tree(t.current_channel_oid),t.display_personal&&t.has_personal_channel){var s=$('<button type="button" class="button channel-personal-btn"><i class="fa fa-bookmark" aria-hidden="true"></i> <span>'+utils.translate("My channel")+"</span></button>");s.click({obj:t},function(e){e.data.obj.open_personal_channel()}),t.$widget.prepend(s)}t.$place.empty(),t.$place.append(t.$widget),t.on_tree_loaded&&t.on_tree_loaded()})}},MSTreeManager.prototype.load_tree=function(e,t){var s,i,a,n,o;if(void 0!==e)if(this.content[e]&&this.content[e].loaded)t&&t({success:!0,oid:e});else if(this.loading)this.loading_queue[e]=t;else{if(this.loading=!0,this.content[e]||(this.content[e]={oid:e}),s={recursive:"no"},"0"!=e&&(s.parent_oid=e),i=this,!(a=$("#"+this.id_prefix+"tree_channel_"+e,this.$widget)).length)return this.loading=!1,void(t&&t({success:!0,oid:e}));this.content[e].timeout=setTimeout(function(){i.content[e].timeout=null,a.css("display","block"),a.html('<li style="display: block;"><i class="fa fa-spinner fa-spin" aria-hidden="true"></i> '+utils.translate("Loading")+"...</li>")},500),n=function(s){i._on_tree_loaded(s,e,a,t)},o=function(s,n,o){if(s.status){if(401==s.status)return i._on_tree_loaded({success:!1,error:utils.translate("Unable to get channels tree because you are not logged in.")},e,a,t);if(403==s.status)return i._on_tree_loaded({success:!1,error:utils.translate("Unable to get channels tree because you cannot access to this channel.")},e,a,t);if(404==s.status)return i._on_tree_loaded({success:!1,error:utils.translate("Channel does not exist.")},e,a,t);if(500==s.status)return i._on_tree_loaded({success:!1,error:utils.translate("An error occurred in the server. Please try again later.")},e,a,t)}"timeout"==n?i._on_tree_loaded({success:!1,error:utils.translate("Unable to get channels tree. Request timed out.")},e,a,t):"error"==n?i._on_tree_loaded({success:!1,error:utils.translate("The server cannot be reached.")},e,a,t):i._on_tree_loaded({success:!1,error:utils.translate("An error occurred during request:")+"<br/>&nbsp;&nbsp;&nbsp;&nbsp;"+n+" "+o},e,a,t)},this.tree_url?$.ajax({url:this.tree_url,data:s,dataType:"json",cache:!1,success:n,error:o}):this.msapi.ajax_call("get_channels_tree",s,function(e){e.success?n(e):o(e.xhr,e.textStatus,e.thrownError)})}},MSTreeManager.prototype._on_tree_loaded=function(e,t,s,i){var a,n,o,l,r,c,d;if(this.content[t].timeout&&(clearTimeout(this.content[t].timeout),delete this.content[t].timeout),e.success){if(e.channels){for(n="",o=0;o<e.channels.length;o++){if((l=e.channels[o]).parent_oid="0"!=t?t:"0",this.content[l.oid])for(r in l)this.content[l.oid][r]=l[r];else this.content[l.oid]=l;this.on_data_retrieved&&this.on_data_retrieved(l),c="",l.channels&&(c='<button type="button" aria-expanded="false" aria-controls="tree_channel_'+l.oid+'" aria-label="'+l.title+'" data-ref="'+l.oid+'" class="channel-toggle button-text list-entry"><i class="fa fa-fw fa-angle-right" aria-hidden="true"></i></button>'),n+='<li><span id="'+this.id_prefix+"tree_channel_"+l.oid+'_link" data-ref="'+l.oid+'" class="'+(this.on_change?"":"aside-list-btn")+(this.current_channel_oid==l.oid?" channel-active":"")+'">'+c,this.on_change?n+="<button "+(l.language?'lang="'+l.language+'"':"")+' type="button" data-ref="'+l.oid+'" class="channel-btn"'+(this.current_channel_oid==l.oid?' title="'+utils.escape_html(l.title)+" "+utils.translate("selected")+'"':"")+">"+utils.escape_html(l.title)+"</button>":n+="<a "+(l.language?'lang="'+l.language+'"':"")+' href="'+this.channels_base_url+l[this.channels_url_field]+'" class="channel-btn">'+utils.escape_html(l.title)+"</a>",n+="</span>",l.channels&&(n+='<ul class="list border-color-blue" id="'+this.id_prefix+"tree_channel_"+l.oid+'"></ul>'),n+="</li>",void 0!==this.loading_queue[l.oid]&&(a={oid:l.oid,cb:this.loading_queue[l.oid]},delete this.loading_queue[l.oid])}d=$(n),s.empty(),s.append(d),this.on_change&&$(".channel-btn",d).click({obj:this},function(e){e.data.obj.on_change($(this).attr("data-ref"))}),$(".channel-toggle",d).click({obj:this},function(e){e.stopPropagation(),e.data.obj.toggle_channel($(this).attr("data-ref"))}),$(".aside-list-btn",d).click({obj:this},function(e){e.stopPropagation(),e.data.obj.toggle_channel($(this).attr("data-ref"))})}this.content[t].loaded=!0,e.personal_channel&&(this.has_personal_channel=!0)}else e.error?s.html('<li class="error">'+e.error+"</li>"):s.html('<li class="error">'+utils.translate("No information about error.")+"</li>");this.loading=!1,a&&this.load_tree(a.oid,a.cb),i&&(e.oid=t,i(e))},MSTreeManager.prototype.open_tree=function(e){var t,s;"0"!=e&&(t=this,s=function(){for(var s,i=[],a=t.content[e];a;)i.push(a.oid),a=t.content[a.parent_oid];for(i.reverse(),s=0;s<i.length;s++)"0"!=i[s]&&t.load_tree(i[s],function(e){$("#"+t.id_prefix+"tree_channel_"+e.oid,t.$widget).css("display","block").addClass("active"),$("#"+t.id_prefix+"tree_channel_"+e.oid+"_link .channel-toggle",t.$widget).addClass("fa-rotate-90"),$("#"+t.id_prefix+"tree_channel_"+e.oid+"_link .channel-toggle",t.$widget).attr("aria-expanded",!0)})},this.content[e]||(this.content[e]={oid:e}),void 0===this.content[e].parent_oid?this.load_path(e,function(i){var a,n,o,l=[];for(i.path&&i.path.length>0&&(l=i.path),l.push(t.content[e]),a=0;a<l.length;a++){if((n=l[a]).parent_oid=a>0?l[a-1].oid:"0",t.content[n.oid])for(o in n)t.content[n.oid][o]=n[o];else t.content[n.oid]=n;t.on_data_retrieved&&t.on_data_retrieved(n)}s()}):s())},MSTreeManager.prototype.close_tree=function(e){$("#"+this.id_prefix+"tree_channel_"+e,this.$widget).css("display","none").removeClass("active"),$("#"+this.id_prefix+"tree_channel_"+e+"_link .channel-toggle",this.$widget).attr("aria-expanded",!1),$("#"+this.id_prefix+"tree_channel_"+e+"_link .channel-toggle",this.$widget).removeClass("fa-rotate-90")},MSTreeManager.prototype.toggle_channel=function(e){$("#"+this.id_prefix+"tree_channel_"+e+"_link .channel-toggle",this.$widget).hasClass("fa-rotate-90")?this.close_tree(e):this.open_tree(e)},MSTreeManager.prototype.set_active=function(e){this.current_channel_oid!=e&&($(".channel-active button",this.$widget).removeAttr("title"),$(".channel-active",this.$widget).removeClass("channel-active"),this.current_channel_oid=e,$("#"+this.id_prefix+"tree_channel_"+this.current_channel_oid+"_link",this.$widget).addClass("channel-active"),$("#"+this.id_prefix+"tree_channel_"+this.current_channel_oid+"_link button",this.$widget).attr("title",$("#"+this.id_prefix+"tree_channel_"+this.current_channel_oid+"_link",this.$widget).text()+" "+utils.translate("selected")),this.open_tree(e))},MSTreeManager.prototype.load_path=function(e,t){var s={oid:e},i=function(s){s.success||console.log("Error getting path for oid "+e+". Error: "+s.error),t(s)},a=function(s,i,a){console.log("Error getting path for oid "+e+". Error: "+i+" | "+a),t({success:!1,error:i+" | "+a})};this.path_url?$.ajax({url:this.path_url,data:s,dataType:"json",cache:!1,success:i,error:a}):this.msapi.ajax_call("get_channels_path",s,function(e){e.success?i(e):a(e.xhr,e.textStatus,e.thrownError)})},MSTreeManager.prototype.open_personal_channel=function(){var e=this,t=function(t){t.success?(e.personal_channel_info=t,$(".channel-personal-btn span",e.$widget).html(utils.translate("My channel")),e.open_tree(t.oid),e.on_change?e.on_change(t.oid):window.location.hash="#"+t.slug):$(".channel-personal-btn span",e.$widget).html(utils.translate("My channel")+" ("+t.xhr.status+")")};this.personal_channel_info?t(this.personal_channel_info):this.msapi.ajax_call("get_channels_personal",{},function(e){t(e)})};